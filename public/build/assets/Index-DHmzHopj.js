import{r,j as e,H as W,a as c,L as x}from"./app-nFOrUbza.js";import{A as G}from"./AdminLayout-BM2bZjzS.js";import{x as D,s as L,u as E,y as J,d as O,e as K,z as V,k as X,A as Y,B as Z,q as P,C as T,D as U,E as ee}from"./index-CQIIe2w9.js";/* empty css            */const de=({sales:l,stats:d,representatives:$,suppliers:Q,filters:a})=>{const[m,u]=r.useState(a.search||""),[p,g]=r.useState(a.status||""),[h,b]=r.useState(a.payment_status||""),[j,y]=r.useState(a.representative_id||""),[v,N]=r.useState(a.supplier_id||""),[f,w]=r.useState(a.date_from||""),[_,S]=r.useState(a.date_to||""),[k,B]=r.useState(a.sort_by||"created_at"),[q,se]=r.useState(a.sort_order||"desc"),[C,A]=r.useState(a.per_page||15),i=[{value:"",label:"جميع الحالات"},{value:"created",label:"تم إنشاؤها",color:"gray"},{value:"pending",label:"في الانتظار",color:"yellow"},{value:"preparing",label:"قيد التجهيز",color:"blue"},{value:"ready_for_delivery",label:"جاهز للتسليم",color:"purple"},{value:"out_for_delivery",label:"مع السائق",color:"indigo"},{value:"delivered",label:"تم التسليم",color:"green"},{value:"completed",label:"مكتمل",color:"emerald"},{value:"cancelled",label:"ملغي",color:"red"}],n=[{value:"",label:"جميع حالات الدفع"},{value:"paid",label:"مدفوع كاملاً",color:"green"},{value:"partial",label:"دفع جزئي",color:"yellow"},{value:"debt",label:"دين",color:"red"}],H=()=>{const s={search:m,status:p,payment_status:h,representative_id:j,supplier_id:v,date_from:f,date_to:_,sort_by:k,sort_order:q,per_page:C};Object.keys(s).forEach(t=>{s[t]||delete s[t]}),c.get("/admin/invoices",s)},R=()=>{u(""),g(""),b(""),y(""),N(""),w(""),S(""),c.get("/admin/invoices")},F=s=>i.find(o=>o.value===s)?.color||"gray",I=s=>n.find(o=>o.value===s)?.color||"gray",M=s=>{switch(s){case"created":return e.jsx(P,{className:"w-3 h-3"});case"pending":return e.jsx(E,{className:"w-3 h-3"});case"preparing":return e.jsx(ee,{className:"w-3 h-3"});case"ready_for_delivery":return e.jsx(U,{className:"w-3 h-3"});case"out_for_delivery":return e.jsx(U,{className:"w-3 h-3"});case"delivered":return e.jsx(T,{className:"w-3 h-3"});case"completed":return e.jsx(T,{className:"w-3 h-3"});default:return e.jsx(P,{className:"w-3 h-3"})}},z=async s=>{if(confirm("هل أنت متأكد من تحويل الفاتورة إلى حالة التجهيز؟"))try{await c.patch(`/admin/invoices/${s}/status`,{status:"preparing",status_notes:"تم تحويل الفاتورة إلى قيد التجهيز"})}catch(t){console.error("Error updating status:",t),alert("حدث خطأ أثناء تحديث حالة الفاتورة")}};return e.jsxs(G,{title:"إدارة الفواتير",children:[e.jsx(W,{title:"إدارة الفواتير"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"إجمالي الفواتير"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:d.total_sales})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"إجمالي المبالغ"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[parseInt(d.total_amount).toLocaleString("en-US")," IQD"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"إجمالي الأرباح"}),e.jsxs("p",{className:"text-lg font-bold text-emerald-600",children:[parseInt(d.total_profit||0).toLocaleString("en-US")," IQD"]})]})]})}),"                    ",e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(E,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"في الانتظار"}),e.jsx("p",{className:"text-lg font-bold text-yellow-600",children:d.pending_invoices})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(J,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"اليوم"}),e.jsx("p",{className:"text-lg font-bold text-indigo-600",children:d.today_sales})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"mr-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"مبيعات اليوم"}),e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[parseInt(d.today_amount).toLocaleString("en-US")," IQD"]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البحث"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:m,onChange:s=>u(s.target.value),placeholder:"رقم الفاتورة، العميل، المندوب...",className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx(O,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"حالة الفاتورة"}),e.jsx("select",{value:p,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:i.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"حالة الدفع"}),e.jsx("select",{value:h,onChange:s=>b(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:n.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المندوب"}),e.jsxs("select",{value:j,onChange:s=>y(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"جميع المندوبين"}),$.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المورد الرئيسي"}),e.jsxs("select",{value:v,onChange:s=>N(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"جميع الموردين"}),Q.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"من تاريخ"}),e.jsx("input",{type:"date",value:f,onChange:s=>w(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"إلى تاريخ"}),e.jsx("input",{type:"date",value:_,onChange:s=>S(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ترتيب حسب"}),e.jsxs("select",{value:k,onChange:s=>B(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"created_at",children:"تاريخ الإنشاء"}),e.jsx("option",{value:"sale_date",children:"تاريخ البيع"}),e.jsx("option",{value:"total_amount",children:"المبلغ الإجمالي"}),e.jsx("option",{value:"total_profit",children:"الربح"}),e.jsx("option",{value:"status",children:"الحالة"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"عدد النتائج"}),e.jsxs("select",{value:C,onChange:s=>A(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(O,{className:"w-4 h-4"}),"تطبيق البحث"]}),e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(K,{className:"w-4 h-4"}),"مسح الفلاتر"]}),e.jsxs("button",{onClick:()=>c.get("/admin/invoices/export/excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(V,{className:"w-4 h-4"}),"تصدير Excel"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"رقم الفاتورة"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المندوب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المورد الرئيسي"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المبلغ الإجمالي"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الربح"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"حالة الفاتورة"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"حالة الدفع"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإنشاء"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.sale_number}),e.jsxs("div",{className:"text-xs text-gray-500",children:["#",s.id]})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.seller_representative?.name||"غير محدد"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.seller_representative?.phone})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.customer?.name||s.customer_name||"عميل حاضر"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.customer?.phone||s.customer_phone})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.primary_supplier?.name_ar||"غير محدد"})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[parseInt(s.total_amount).toLocaleString("en-US")," IQD"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Paid: ",parseInt(s.paid_amount).toLocaleString("en-US")," IQD"]})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"font-medium text-green-600",children:[parseInt(s.total_profit||0).toLocaleString("en-US")," IQD"]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-${F(s.status)}-100 text-${F(s.status)}-800`,children:[M(s.status),i.find(t=>t.value===s.status)?.label||s.status]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${I(s.payment_status)}-100 text-${I(s.payment_status)}-800`,children:n.find(t=>t.value===s.payment_status)?.label||s.payment_status})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[e.jsx("div",{children:new Date(s.created_at).toLocaleDateString("en-US")}),e.jsx("div",{className:"text-xs",children:new Date(s.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(x,{href:`/admin/invoices/${s.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"عرض التفاصيل",children:e.jsx(X,{className:"w-4 h-4"})}),s.status==="pending"&&e.jsx("button",{onClick:()=>z(s.id),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",title:"تحويل إلى التجهيز",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(x,{href:`/admin/invoices/${s.id}/print`,className:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"طباعة",children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},s.id))})]})}),l.links&&e.jsx("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["عرض ",e.jsx("span",{className:"font-medium",children:l.from})," إلى ",e.jsx("span",{className:"font-medium",children:l.to})," من ",e.jsx("span",{className:"font-medium",children:l.total})," نتيجة"]})}),e.jsx("div",{className:"flex items-center gap-2",children:l.links.map((s,t)=>s.url?e.jsx(x,{href:s.url,className:`px-3 py-2 text-sm rounded-lg transition-colors ${s.active?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,dangerouslySetInnerHTML:{__html:s.label}},t):e.jsx("span",{className:"px-3 py-2 text-sm text-gray-500 bg-gray-100 rounded-lg",children:s.label.replace("&laquo;","«").replace("&raquo;","»")},t))})]})})]})]})]})};export{de as default};
