import{r as a,j as e,H as Y,a as Z}from"./app-DLu82VbL.js";import{R as Q}from"./RepresentativeLayout-Dd1lkglj.js";import{d as ee,U as se,N as q,V as W,K as w,l as te,W as ae,X as re}from"./index-UdTL3sIO.js";/* empty css            */const _e=({products:c,customers:le,representatives:ne,flash:f})=>{const[l,o]=a.useState([]),[d,P]=a.useState(""),[_,T]=a.useState(c||[]),[u,j]=a.useState(""),[p,E]=a.useState(""),I=[...new Set((c||[]).map(s=>s.category).filter(Boolean))],[ie,ce]=a.useState("cash"),[oe,R]=a.useState(null),[de,L]=a.useState(null),[xe,B]=a.useState(""),[ge,K]=a.useState(""),[$,M]=a.useState(0),[he,z]=a.useState(""),[me,D]=a.useState(""),[ue,pe]=a.useState(!1),[be,G]=a.useState({}),[C,y]=a.useState(!1),[A,b]=a.useState(!1),[x,H]=a.useState(null),O=a.useRef(null),U=a.useRef(null);a.useEffect(()=>{let s=c||[];p&&(s=s.filter(t=>t.category===p)),d&&(s=s.filter(t=>t.name.toLowerCase().includes(d.toLowerCase())||t.barcode.includes(d))),T(s)},[d,p,c]),a.useEffect(()=>{f?.success&&alert(f.success)},[f]),a.useEffect(()=>{v()},[]);const S=async()=>{if(!u.trim())return;const s=c.find(t=>t.barcode===u);if(s){N(s),j("");return}try{const r=await(await fetch(`/representatives/pos/search-product?barcode=${u}`)).json();r.product?N(r.product):alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬")}catch(t){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«:",t),alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬")}j("")},V=s=>{const t=s.image?`/storage/${s.image}`:"/images/no-product-image.png";H({src:t,name:s.name,barcode:s.barcode}),b(!0)},N=s=>{if(s.quantity<=0){alert("Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†");return}const t=l.find(r=>r.id===s.id);if(t){if(t.quantity+1>s.quantity){alert(`Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©: ${s.quantity}`);return}o(l.map(r=>r.id===s.id?{...r,quantity:r.quantity+1}:r))}else{const r={id:s.id,product:s,quantity:1,unit_sale_price:parseFloat(s.selling_price||0),unit_discount:0};o([...l,r])}},F=(s,t)=>{if(t<=0){k(s);return}o(l.map(r=>{if(r.id===s){const g=r.product;return t>g.quantity?(alert(`Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©: ${g.quantity}`),r):{...r,quantity:t}}return r}))},k=s=>{o(l.filter(t=>t.id!==s))},v=()=>{o([]),R(null),L(null),B(""),K(""),M(0),z(""),D(""),G({})},i=(()=>{const s=l.reduce((h,n)=>{const m=parseFloat(n.quantity||0)*parseFloat(n.unit_sale_price||0);return h+m},0),t=s,r=t-parseFloat($||0),g=l.reduce((h,n)=>{const m=parseFloat(n.product?.piece_weight_grams)||0,X=parseFloat(n.product?.pieces_per_carton)||1,J=(parseFloat(n.quantity)||0)*X*m;return h+J},0);return{subtotal:s,total:t,remaining:r,totalWeightGrams:g,totalWeightKg:g/1e3,profit:l.reduce((h,n)=>{const m=(parseFloat(n.unit_sale_price||0)-parseFloat(n.product?.purchase_price||0))*parseFloat(n.quantity||0);return h+m},0)}})();return e.jsxs(Q,{title:"Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹",children:[e.jsx(Y,{title:"Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ø§Ù„Ø¨Ø­Ø«"}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{ref:U,type:"text",value:d,onChange:s=>P(s.target.value),placeholder:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯...",className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ø§Ù„ÙØ¦Ø©"}),e.jsxs("select",{value:p,onChange:s=>E(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª"}),I.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(se,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{ref:O,type:"text",value:u,onChange:s=>j(s.target.value),onKeyPress:s=>s.key==="Enter"&&S(),placeholder:"Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯...",className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsx("button",{onClick:S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Ø¥Ø¶Ø§ÙØ©"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:_.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-3 p-3",children:_.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("img",{src:s.image?`/storage/${s.image}`:"/images/no-product-image.png",alt:s.name,className:"w-full h-24 object-cover rounded-lg cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>V(s),onError:t=>{t.target.src="/images/no-product-image.png"}}),e.jsxs("div",{className:"absolute top-1 right-1 bg-white px-1 py-0.5 rounded text-xs font-medium text-gray-600 shadow-sm",children:["#",s.barcode]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm leading-tight overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:s.name}),s.category&&e.jsx("div",{className:"text-xs text-blue-600 font-medium",children:s.category}),e.jsx("div",{className:"text-xs text-gray-600",children:s.supplier_name||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}),(s.pieces_per_carton||s.piece_weight_grams)&&e.jsxs("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:[s.pieces_per_carton&&e.jsxs("span",{className:"mr-2",children:["ðŸ§© ",s.pieces_per_carton,"/ÙƒØ§Ø±ØªÙˆÙ†"]}),s.piece_weight_grams&&e.jsxs("span",{children:["âš–ï¸ ",s.piece_weight_grams,"Øº"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-green-600 font-semibold",children:[s.selling_price," Ø¯.Ø¹"]}),e.jsxs("span",{className:"text-gray-500 text-xs",children:["/",s.unit]})]}),e.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded-full",children:s.quantity})]}),e.jsxs("button",{onClick:()=>N(s),disabled:s.quantity<=0,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[e.jsx(q,{className:"w-3 h-3"}),"Ø¥Ø¶Ø§ÙØ©"]})]})]},s.id))}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…ØªØ§Ø­Ø©"})})})})]}),e.jsxs("button",{onClick:()=>y(!C),className:"fixed bottom-6 left-6 w-16 h-16 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-700 transition-all duration-300 flex items-center justify-center z-40",children:[e.jsx(W,{className:"w-6 h-6"}),l.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center",children:l.length})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center bg-green-600 text-white",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø¯ÙØ¹"}),e.jsx("button",{onClick:()=>y(!1),className:"text-white hover:text-gray-200 p-1",children:e.jsx(w,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex flex-col h-full max-h-[80vh]",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø³Ù„Ø©"}),l.length>0&&e.jsx("button",{onClick:v,className:"text-red-500 hover:text-red-700 p-1",title:"Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©",children:e.jsx(te,{className:"w-4 h-4"})})]}),l.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©"})]}):e.jsx("div",{className:"flex-1 overflow-y-auto max-h-96",children:l.map(s=>e.jsxs("div",{className:"p-4 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:s.product.name}),e.jsx("button",{onClick:()=>k(s.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(w,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{onClick:()=>F(s.id,s.quantity-1),className:"w-6 h-6 flex items-center justify-center bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:e.jsx(ae,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium min-w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>F(s.id,s.quantity+1),className:"w-6 h-6 flex items-center justify-center bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:e.jsx(q,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600",children:"Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹"}),e.jsxs("div",{className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100 text-gray-700",children:[parseFloat(s.unit_sale_price||0).toFixed(2)," Ø¯.Ø¹"]})]}),e.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded",children:[s.product.pieces_per_carton&&e.jsxs("div",{children:["ðŸ§© ",s.product.pieces_per_carton," Ù‚Ø·Ø¹Ø©/ÙƒØ§Ø±ØªÙˆÙ†"]}),s.product.piece_weight_grams&&e.jsxs("div",{children:["âš–ï¸ ",s.product.piece_weight_grams," Øº/Ù‚Ø·Ø¹Ø©"]}),s.product.piece_weight_grams&&e.jsxs("div",{className:"text-purple-600 font-medium",children:["Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ: ",(s.quantity*(s.product.pieces_per_carton||1)*s.product.piece_weight_grams).toLocaleString()," ØºØ±Ø§Ù…",e.jsxs("div",{className:"text-xs text-gray-500",children:["(",s.quantity," ÙƒØ§Ø±ØªÙˆÙ† Ã— ",s.product.pieces_per_carton||1," Ù‚Ø·Ø¹Ø© Ã— ",s.product.piece_weight_grams," Øº)"]})]})]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:["Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ",(parseFloat(s.unit_sale_price||0)*parseFloat(s.quantity||0)).toFixed(2)," Ø¯.Ø¹"]})})]},s.id))}),l.length>0&&e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:"}),e.jsxs("span",{className:"font-semibold",children:[i.subtotal.toFixed(2)," Ø¯.Ø¹"]})]}),i.totalWeightGrams>0&&e.jsxs("div",{className:"flex justify-between text-sm text-purple-600",children:[e.jsx("span",{children:"Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ:"}),e.jsxs("span",{className:"font-semibold",children:[i.totalWeightGrams.toLocaleString()," ØºØ±Ø§Ù…",i.totalWeightKg>=1&&e.jsxs("span",{className:"ml-1",children:["(",i.totalWeightKg.toFixed(2)," ÙƒØº)"]})]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:"}),e.jsxs("span",{className:"text-green-600",children:[i.total.toFixed(2)," Ø¯.Ø¹"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{y(!1),Z.visit("/representatives/pos/invoice",{method:"post",data:{cart:l}})},disabled:l.length===0,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[e.jsx(re,{className:"w-4 h-4"}),"Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹"]}),e.jsx("button",{onClick:v,className:"px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Ù…Ø³Ø­"})]})]})]})})]})}),A&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4",onClick:()=>b(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:x.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Ø¨Ø§Ø±ÙƒÙˆØ¯: #",x.barcode]})]}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(w,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-4",children:e.jsx("img",{src:x.src,alt:x.name,className:"w-full h-auto max-h-[60vh] object-contain rounded-lg",onError:s=>{s.target.src="/images/no-product-image.png"}})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 text-center",children:e.jsx("button",{onClick:()=>b(!1),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})})]})};export{_e as default};
