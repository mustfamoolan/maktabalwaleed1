import{r as x,j as e,a as C}from"./app-nFOrUbza.js";import{A as ae}from"./AdminLayout-BM2bZjzS.js";import{B as J}from"./BarcodeManager-C-KtJd5w.js";/* empty css            */function ge({products:Q,suppliers:h,categories:le,productCategories:N}){const[y,H]=x.useState(""),[S,G]=x.useState(""),[T,ie]=x.useState(""),[q,V]=x.useState(""),[M,X]=x.useState("all"),[_,Z]=x.useState("all"),[E,F]=x.useState({}),[ne,oe]=x.useState(0),[f,j]=x.useState({}),[ee,b]=x.useState(!1),[g,R]=x.useState(!1),[W,z]=x.useState(null),[A,$]=x.useState(null),[p,w]=x.useState(""),[o,c]=x.useState({name_ar:"",name_en:"",description:"",supplier_id:"",category_id:"",barcode:"",barcode_type:"auto",cost_price:"",purchase_price:"",selling_price:"",wholesale_price:"",stock_quantity:"0",min_stock_level:"1",expiry_date:"",image:null,is_active:!0}),[O,L]=x.useState(!1),se=()=>{R(!1),z(null),$(null),w(""),c({name_ar:"",name_en:"",description:"",supplier_id:"",category_id:"",barcode:"",barcode_type:"auto",cost_price:"",purchase_price:"",selling_price:"",wholesale_price:"",stock_quantity:"0",min_stock_level:"1",expiry_date:"",image:null,is_active:!0}),b(!0)},re=s=>{R(!0),z(s.id),w(s.supplier_id),$(s.image),c({name_ar:s.name_ar||"",name_en:s.name_en||"",description:s.description||"",supplier_id:s.supplier_id||"",category_id:s.category_id||"",barcode:s.barcode||"",barcode_type:s.barcode_type||"auto",cost_price:s.cost_price||"",purchase_price:s.purchase_price||"",selling_price:s.selling_price||"",wholesale_price:s.wholesale_price||"",stock_quantity:s.stock_quantity||"0",min_stock_level:s.min_stock_level||"1",expiry_date:s.expiry_date||"",image:null,is_active:s.is_active}),b(!0)},te=async()=>{if(!o.name_ar||!o.supplier_id||!o.purchase_price||!o.selling_price){alert("يرجى ملء الحقول المطلوبة (اسم المنتج، المورد، سعر الشراء، سعر البيع)");return}L(!0);try{g&&W?C.put(route("admin.products.update",W),o,{onSuccess:()=>{B()},onError:s=>{console.error("أخطاء التعديل:",s),alert("حدث خطأ أثناء تعديل المنتج: "+Object.values(s).join(", "))},onFinish:()=>{L(!1)}}):C.post(route("admin.products.store"),o,{onSuccess:()=>{B()},onError:s=>{console.error("أخطاء الحفظ:",s),alert("حدث خطأ أثناء حفظ المنتج: "+Object.values(s).join(", "))},onFinish:()=>{L(!1)}})}catch(s){console.error("خطأ في الحفظ:",s),alert("حدث خطأ أثناء حفظ المنتج"),L(!1)}},B=()=>{b(!1),R(!1),z(null),$(null),w(""),c({name_ar:"",name_en:"",description:"",supplier_id:"",category_id:"",barcode:"",barcode_type:"auto",cost_price:"",purchase_price:"",selling_price:"",wholesale_price:"",stock_quantity:"0",min_stock_level:"1",expiry_date:"",image:null,is_active:!0})},P=()=>{if(!p)return console.log("لم يتم اختيار مورد في النافذة المنسدلة"),[];const s=h.find(l=>l.id==p);if(!s)return console.log("لم يتم العثور على المورد في النافذة المنسدلة:",p),[];console.log("المورد المختار في النافذة المنسدلة:",s),console.log("فئات المورد - all_categories:",s.all_categories),console.log("فئات المورد - categories:",s.categories),console.log("فئات المورد - supplier_categories:",s.supplier_categories);const t=s.all_categories||s.categories||s.supplier_categories||[];return console.log("الفئات المرجعة في النافذة المنسدلة:",t),t},u=(s,t,l)=>{F(r=>{const a=r[s]||{};return{...r,[s]:{...a,[t]:l}}})},Y=(s,t)=>{if(t){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(t.type)){alert("نوع الملف غير مدعوم. يرجى اختيار صورة من نوع: JPEG, PNG, GIF, أو WebP");return}if(t.size>5*1024*1024){alert("حجم الملف كبير جداً. الحد الأقصى هو 5 ميجابايت");return}console.log("معلومات الملف:",{name:t.name,type:t.type,size:t.size,lastModified:new Date(t.lastModified)}),u(s,"image",t);const r=new FileReader;r.onload=a=>{u(s,"imagePreview",a.target.result)},r.readAsDataURL(t)}},K=async s=>{const t=E[s];j(r=>({...r,[s]:!0}));const l=new FormData;Object.keys(t).forEach(r=>{if(r!=="isNew"&&r!=="imagePreview"&&t[r]!==null&&t[r]!==void 0)if(r==="image")if(t[r]instanceof File){console.log("تفاصيل الملف قبل الإرسال:",{name:t[r].name,size:t[r].size,type:t[r].type,lastModified:t[r].lastModified});const a=new File([t[r]],t[r].name,{type:t[r].type,lastModified:t[r].lastModified});l.append(r,a),console.log("إرسال صورة جديدة:",a.name)}else console.log("تجاهل الصورة القديمة:",t[r]);else r==="is_active"?l.append(r,t[r]?"1":"0"):l.append(r,t[r])}),console.log("محتويات FormData:");for(let[r,a]of l.entries())a instanceof File?console.log(`${r}:`,{name:a.name,size:a.size,type:a.type}):console.log(`${r}:`,a);try{t.isNew?(l.append("_method","POST"),C.post(route("admin.products.store"),l,{forceFormData:!0,onSuccess:()=>{F(r=>{const a={...r};return delete a[s],a}),j(r=>{const a={...r};return delete a[s],a})},onError:r=>{console.error("خطأ في الحفظ:",r),alert("حدث خطأ أثناء الحفظ. يرجى التحقق من البيانات."),j(a=>{const n={...a};return delete n[s],n})}})):(l.append("_method","PUT"),C.post(route("admin.products.update",t.id),l,{forceFormData:!0,onSuccess:()=>{F(r=>{const a={...r};return delete a[s],a}),j(r=>{const a={...r};return delete a[s],a})},onError:r=>{console.error("خطأ في التحديث:",r),alert("حدث خطأ أثناء التحديث. يرجى التحقق من البيانات."),j(a=>{const n={...a};return delete n[s],n})}}))}catch(r){console.error("خطأ في حفظ البيانات:",r),alert("حدث خطأ أثناء الحفظ. يرجى المحاولة مرة أخرى."),j(a=>{const n={...a};return delete n[s],n})}},k=s=>{F(t=>{const l={...t};return delete l[s],l})},U=s=>{re(s)},I=s=>{confirm("هل أنت متأكد من حذف هذا المنتج؟")&&C.delete(route("admin.products.destroy",s.id))},v=Q.filter(s=>{const t=!y||s.name_ar.toLowerCase().includes(y.toLowerCase())||s.name_en?.toLowerCase().includes(y.toLowerCase())||s.barcode?.includes(y),l=!S||s.supplier_id==S,r=!T||s.supplier?.category?.id==T,a=!q||s.category?.id==q,n=M==="all"||M==="active"&&s.is_active||M==="inactive"&&!s.is_active,i=_==="all"||_==="in_stock"&&(s.stock_quantity||0)>0||_==="low_stock"&&(s.stock_quantity||0)<=(s.min_stock_level||0)&&(s.stock_quantity||0)>0||_==="out_of_stock"&&(s.stock_quantity||0)===0;return t&&l&&r&&a&&n&&i}),D=s=>new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s||0),m=({rowId:s,field:t,value:l,type:r="text",options:a=[]})=>{const n=E[s];if(!n){if(r==="image")return e.jsx("div",{className:"flex items-center justify-center w-12 h-12",children:l?e.jsx("img",{src:`/storage/${l}`,alt:"صورة المنتج",className:"w-full h-full object-cover rounded border",onError:i=>{i.target.style.display="none"}}):e.jsx("div",{className:"w-full h-full bg-gray-100 rounded border flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})});if(r==="select"&&a.length>0){const i=a.find(d=>d.id==l);return e.jsx("span",{className:"text-xs truncate block max-w-full",title:i?.name_ar||"-",children:i?.name_ar||"-"})}return r==="price"?e.jsx("span",{className:"text-xs font-medium text-green-600 truncate block",title:D(l),children:D(l)}):r==="boolean"?e.jsx("span",{className:`inline-flex px-1 py-0.5 text-xs font-medium rounded-full whitespace-nowrap ${l?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l?"نشط":"غير نشط"}):e.jsx("span",{className:"text-xs truncate block max-w-full",title:l||"-",children:l||"-"})}return r==="image"?e.jsxs("div",{className:"w-full",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:i=>{const d=i.target.files[0];d&&Y(s,d)},className:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),n.imagePreview&&e.jsx("div",{className:"mt-1 w-12 h-12",children:e.jsx("img",{src:n.imagePreview,alt:"معاينة",className:"w-full h-full object-cover rounded border"})})]}):r==="select"?e.jsxs("select",{value:n[t]||"",onChange:i=>u(s,t,i.target.value),onKeyDown:i=>{if(i.key==="Enter"){i.preventDefault();const d=i.target.closest("tr").querySelector("input:not([readonly]), select:not([readonly])");d&&d!==i.target&&d.focus()}i.key==="Escape"&&k(s)},className:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"اختر..."}),a.map(i=>e.jsx("option",{value:i.id,children:i.name_ar},i.id))]}):r==="boolean"?e.jsxs("select",{value:n[t]?"true":"false",onChange:i=>u(s,t,i.target.value==="true"),onKeyDown:i=>{if(i.key==="Enter"){i.preventDefault();const d=i.target.closest("tr").querySelector("input:not([readonly]), select:not([readonly])");d&&d!==i.target&&d.focus()}i.key==="Escape"&&k(s)},className:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"true",children:"نشط"}),e.jsx("option",{value:"false",children:"غير نشط"})]}):r==="barcode"?e.jsx("div",{className:"w-full",children:e.jsx(J,{value:n[t]||"",onChange:i=>u(s,t,i),showGenerator:!0,showScanner:!0,generateAutomatic:!0,className:"border-0 p-0",label:""})}):e.jsx("input",{type:r==="price"||r==="number"?"number":r==="date"?"date":"text",step:r==="price"?"0.01":void 0,value:n[t]||"",onChange:i=>u(s,t,i.target.value),onFocus:i=>{setTimeout(()=>i.target.select(),0)},onKeyDown:i=>{if(i.key==="Enter"){i.preventDefault();const d=i.target.closest("tr").querySelector("input:not([readonly]), select:not([readonly])");d&&d!==i.target&&d.focus()}i.key==="Escape"&&k(s)},className:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:r==="date"?"YYYY-MM-DD":"",autoComplete:"off"})};return e.jsxs(ae,{children:[ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200 bg-blue-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:g?"تعديل المنتج":"إضافة منتج جديد"}),e.jsx("button",{onClick:()=>{b(!1),w("")},className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]})}),e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 border-b pb-2",children:"المعلومات الأساسية"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم المنتج (عربي) *"}),e.jsx("input",{type:"text",value:o.name_ar,onChange:s=>c(t=>({...t,name_ar:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"أدخل اسم المنتج بالعربية"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم المنتج (إنجليزي)"}),e.jsx("input",{type:"text",value:o.name_en,onChange:s=>c(t=>({...t,name_en:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Product Name (English)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف"}),e.jsx("textarea",{rows:"3",value:o.description,onChange:s=>c(t=>({...t,description:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"وصف المنتج (اختياري)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"صورة المنتج"}),g&&A&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"الصورة الحالية:"}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:`/storage/${A}`,alt:"الصورة الحالية",className:"w-24 h-24 object-cover rounded-lg border"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 rounded-lg flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"text-white text-xs",children:"الصورة الحالية"})})]})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 sm:p-6 text-center hover:border-blue-400 transition-colors",children:[e.jsx("svg",{className:"mx-auto h-8 sm:h-12 w-8 sm:w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("div",{className:"mt-2",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"mt-2 block text-xs sm:text-sm font-medium text-gray-900",children:g?"اضغط لتغيير الصورة":"اضغط لرفع صورة أو اسحب الصورة هنا"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:s=>c(t=>({...t,image:s.target.files[0]}))})]})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:[g?"اترك فارغاً للاحتفاظ بالصورة الحالية • ":"","PNG, JPG, GIF حتى 5MB"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 border-b pb-2",children:"التفاصيل والأسعار"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المورد *"}),e.jsxs("select",{value:p,onChange:s=>{const t=s.target.value;w(t),c(l=>({...l,supplier_id:t,category_id:""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"اختر المورد"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة المنتج"}),e.jsxs("select",{value:o.category_id,onChange:s=>c(t=>({...t,category_id:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:!p,children:[e.jsx("option",{value:"",children:p?"اختر الفئة":"اختر المورد أولاً"}),P().map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id)),p&&P().length===0&&N.map(s=>e.jsxs("option",{value:s.id,children:[s.name_ar," (عام)"]},`fallback_${s.id}`))]}),p&&P().length===0&&N.length>0&&e.jsx("p",{className:"mt-1 text-xs text-blue-600",children:"تم عرض جميع الفئات (المورد ليس له فئات محددة)"}),p&&P().length===0&&N.length===0&&e.jsx("p",{className:"mt-1 text-xs text-amber-600",children:"لا توجد فئات منتجات متاحة"})]})]}),e.jsx("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg",children:e.jsx(J,{value:o.barcode,onChange:s=>c(t=>({...t,barcode:s})),showGenerator:!0,showScanner:!0,generateAutomatic:!g,label:g?`الباركود الحالي: ${o.barcode||"غير محدد"}`:"نظام الباركود المتقدم"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سعر الشراء *"}),e.jsx("input",{type:"number",step:"0.01",value:o.purchase_price,onChange:s=>c(t=>({...t,purchase_price:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سعر البيع *"}),e.jsx("input",{type:"number",step:"0.01",value:o.selling_price,onChange:s=>c(t=>({...t,selling_price:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سعر الجملة"}),e.jsx("input",{type:"number",step:"0.01",value:o.wholesale_price,onChange:s=>c(t=>({...t,wholesale_price:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كمية المخزون"}),e.jsx("input",{type:"number",value:o.stock_quantity,onChange:s=>c(t=>({...t,stock_quantity:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأدنى"}),e.jsx("input",{type:"number",value:o.min_stock_level,onChange:s=>c(t=>({...t,min_stock_level:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الصلاحية"}),e.jsx("input",{type:"date",value:o.expiry_date,onChange:s=>c(t=>({...t,expiry_date:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حالة المنتج"}),e.jsxs("select",{value:o.is_active,onChange:s=>c(t=>({...t,is_active:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:!0,children:"نشط"}),e.jsx("option",{value:!1,children:"غير نشط"})]})]})]})]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-4 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row justify-end gap-3",children:[e.jsx("button",{onClick:B,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"إلغاء"}),e.jsx("button",{onClick:te,disabled:O,className:"px-4 sm:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 text-sm disabled:opacity-50",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),g?"جار التعديل...":"جار الحفظ..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),g?"تعديل المنتج":"إضافة المنتج"]})})]})]})}),e.jsxs("div",{className:"hidden lg:flex flex-col h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white shadow-sm border-b border-gray-200 flex-shrink-0",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"إدارة المنتجات"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"إدارة وتنظيم المنتجات مثل الاكسل"})]}),e.jsxs("button",{onClick:se,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة صف جديد"]})]})}),e.jsx("div",{className:"px-6 py-3 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"البحث...",value:y,onChange:s=>H(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:S,onChange:s=>G(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع الموردين"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:q,onChange:s=>V(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع الفئات"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:M,onChange:s=>X(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"inactive",children:"غير نشط"})]})}),e.jsx("div",{children:e.jsxs("select",{value:_,onChange:s=>Z(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"جميع المخزونات"}),e.jsx("option",{value:"in_stock",children:"متوفر"}),e.jsx("option",{value:"low_stock",children:"منخفض"}),e.jsx("option",{value:"out_of_stock",children:"نفذ"})]})}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:["المجموع: ",v.length]})]})})]}),e.jsx("div",{className:"flex-1 bg-white overflow-hidden",children:e.jsx("div",{className:"h-full overflow-auto",children:e.jsxs("table",{className:"w-full table-fixed border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-12",children:"#"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-16",children:"الصورة"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-40",children:"اسم المنتج (عربي)"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-36",children:"اسم المنتج (إنجليزي)"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-28",children:"المورد"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-24",children:"الفئة"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-28",children:"الباركود"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-28",children:"سعر الشراء"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-28",children:"سعر البيع"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-28",children:"سعر الجملة"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-16",children:"المخزون"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-16",children:"الحد الأدنى"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase border-r border-gray-200 w-12",children:"الحالة"}),e.jsx("th",{className:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase w-20",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map((s,t)=>{const l=E[s.id],r=s.id;return e.jsxs("tr",{className:`hover:bg-gray-50 ${l?"bg-blue-50 border-l-2 border-blue-400":""}`,children:[e.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 border-r border-gray-200",children:t+1}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"image",value:s.image,type:"image"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"name_ar",value:s.name_ar})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"name_en",value:s.name_en})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"supplier_id",value:s.supplier_id,type:"select",options:h})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"category_id",value:s.category_id,type:"select",options:N})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"barcode",value:s.barcode,type:"barcode"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"purchase_price",value:s.purchase_price,type:"price"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"selling_price",value:s.selling_price,type:"price"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"wholesale_price",value:s.wholesale_price,type:"price"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"stock_quantity",value:s.stock_quantity,type:"number"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"min_stock_level",value:s.min_stock_level,type:"number"})}),e.jsx("td",{className:"px-2 py-1 border-r border-gray-200",children:e.jsx(m,{rowId:r,field:"is_active",value:s.is_active,type:"boolean"})}),e.jsx("td",{className:"px-2 py-1",children:e.jsx("div",{className:"flex items-center gap-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>K(r),disabled:f[r],className:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white p-1 rounded text-xs w-6 h-6 flex items-center justify-center",title:"حفظ",children:f[r]?e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):"✓"}),e.jsx("button",{onClick:()=>k(r),disabled:f[r],className:"bg-gray-600 hover:bg-gray-700 disabled:bg-gray-300 text-white p-1 rounded text-xs w-6 h-6 flex items-center justify-center",title:"إلغاء",children:"✕"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>U(s),className:"bg-blue-600 hover:bg-blue-700 text-white p-1 rounded text-xs w-6 h-6 flex items-center justify-center",title:"تعديل",children:"✏️"}),!s.isNew&&e.jsx("button",{onClick:()=>I(s),className:"bg-red-600 hover:bg-red-700 text-white p-1 rounded text-xs w-6 h-6 flex items-center justify-center",title:"حذف",children:"🗑️"})]})})})]},r)})})]})})}),v.length===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"📦"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد منتجات"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على أي منتجات. ابدأ بإضافة منتج جديد."}),e.jsx("button",{onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:"إضافة المنتج الأول"})]})]}),e.jsxs("div",{className:"lg:hidden min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white shadow-sm sticky top-0 z-40",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"إدارة المنتجات"}),e.jsx("p",{className:"text-sm text-gray-600",children:"إدارة وتنظيم المنتجات"})]}),e.jsxs("button",{onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة منتج"]})]})}),e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"البحث...",value:y,onChange:s=>H(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500"}),e.jsxs("select",{value:S,onChange:s=>G(s.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع الموردين"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-2 text-center",children:["المجموع: ",v.length," منتج"]})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[v.map((s,t)=>{const l=E[s.id],r=s.id;return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 p-4 ${l?"ring-2 ring-blue-400 border-blue-400":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden border border-gray-200 flex-shrink-0",children:s.image?e.jsx("img",{src:`/storage/${s.image}`,alt:"صورة المنتج",className:"w-full h-full object-cover",onError:a=>{a.target.style.display="none"}}):e.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:l?e.jsx("input",{type:"text",value:l.name_ar||"",onChange:a=>u(r,"name_ar",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"اسم المنتج (عربي)"}):s.name_ar||"غير محدد"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["رقم ",t+1," • ",s.barcode||"بدون باركود"]})]})]}),e.jsx("div",{className:"flex items-center gap-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>K(r),disabled:f[r],className:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white p-2 rounded text-xs",title:"حفظ",children:f[r]?e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):"✓"}),e.jsx("button",{onClick:()=>k(r),disabled:f[r],className:"bg-gray-600 hover:bg-gray-700 disabled:bg-gray-300 text-white p-2 rounded text-xs",title:"إلغاء",children:"✕"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>U(s),className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded text-xs",title:"تعديل",children:"✏️"}),!s.isNew&&e.jsx("button",{onClick:()=>I(s),className:"bg-red-600 hover:bg-red-700 text-white p-2 rounded text-xs",title:"حذف",children:"🗑️"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"الاسم الإنجليزي"}),l?e.jsx("input",{type:"text",value:l.name_en||"",onChange:a=>u(r,"name_en",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Product Name (English)"}):e.jsx("div",{className:"text-sm text-gray-600",children:s.name_en||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"المورد"}),l?e.jsxs("select",{value:l.supplier_id||"",onChange:a=>u(r,"supplier_id",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"اختر المورد"}),h.map(a=>e.jsx("option",{value:a.id,children:a.name_ar},a.id))]}):e.jsx("div",{className:"text-sm text-gray-600",children:h.find(a=>a.id==s.supplier_id)?.name_ar||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"سعر الشراء"}),l?e.jsx("input",{type:"number",value:l.purchase_price||"",onChange:a=>u(r,"purchase_price",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"0"}):e.jsx("div",{className:"text-sm font-medium text-green-600",children:D(s.purchase_price)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"سعر البيع"}),l?e.jsx("input",{type:"number",value:l.selling_price||"",onChange:a=>u(r,"selling_price",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"0"}):e.jsx("div",{className:"text-sm font-medium text-green-600",children:D(s.selling_price)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"المخزون"}),l?e.jsx("input",{type:"number",value:l.stock_quantity||"",onChange:a=>u(r,"stock_quantity",a.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"0"}):e.jsx("div",{className:"text-sm text-gray-600",children:s.stock_quantity||"0"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"الحالة"}),l?e.jsxs("select",{value:l.is_active?"true":"false",onChange:a=>u(r,"is_active",a.target.value==="true"),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"true",children:"نشط"}),e.jsx("option",{value:"false",children:"غير نشط"})]}):e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"نشط":"غير نشط"})]}),l&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"تغيير الصورة"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{const n=a.target.files[0];n&&Y(r,n)},className:"text-xs border border-gray-300 rounded p-1"})]})]})]})]},r)}),v.length===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-3",children:"📦"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد منتجات"}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:"لم يتم العثور على أي منتجات. ابدأ بإضافة منتج جديد."}),e.jsx("button",{onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm",children:"إضافة المنتج الأول"})]})]})]})]})}export{ge as default};
