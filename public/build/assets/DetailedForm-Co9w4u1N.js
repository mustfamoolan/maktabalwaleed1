import{r as N,u as k,j as e}from"./app-C7cjIxtJ.js";import{X as w,S as C,n as u}from"./index-DjG75rFv.js";import{c as S}from"./createLucideIcon-OegKdwhO.js";import{D as x}from"./dollar-sign-C4ryzcvL.js";import{T as c,C as b,S as $}from"./target-Go6GZXUt.js";import"./app-D2X_br3j.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],D=S("settings",q);function F({representative:s,incentivePlans:g,isOpen:h,onClose:d}){const[l,p]=N.useState("financial"),{data:a,setData:n,put:f,processing:m,errors:r}=k({base_salary:s?.base_salary||"",incentive_plan:s?.incentive_plan||"fixed_commission",incentive_settings:s?.incentive_settings||"",monthly_target:s?.monthly_target||"",quarterly_target:s?.quarterly_target||"",annual_target:s?.annual_target||"",bank_account:s?.bank_account||"",bank_name:s?.bank_name||"",iban:s?.iban||"",national_id:s?.national_id||"",hire_date:s?.hire_date||"",birth_date:s?.birth_date||"",city:s?.city||"",notes:s?.notes||"",incentive_plans:s?.incentive_plans?.map(t=>t.id)||[]}),y=[{id:"financial",name:"المعلومات المالية",icon:x},{id:"targets",name:"الأهداف والحوافز",icon:c},{id:"banking",name:"المعلومات البنكية",icon:b},{id:"additional",name:"معلومات إضافية",icon:$}],_=t=>{t.preventDefault(),f(route("admin.sales-representatives.update",s.id),a,{onSuccess:()=>{u.success("تم تحديث بيانات المندوب بنجاح"),d()},onError:i=>{const o=Object.values(i)[0];u.error(o||"حدث خطأ أثناء الحفظ")}})},j=t=>{switch(t){case"fixed_commission":return JSON.stringify({commission_rate:5},null,2);case"tiered_commission":return JSON.stringify({tiers:[{min_amount:0,max_amount:1e5,commission_rate:3},{min_amount:100001,max_amount:5e5,commission_rate:5},{min_amount:500001,max_amount:null,commission_rate:7}]},null,2);case"target_bonus":return JSON.stringify({base_commission_rate:3,bonus_commission_rate:2,achievement_threshold:100},null,2);default:return""}},v=t=>{n("incentive_plan",t),(!a.incentive_settings||a.incentive_settings.trim()==="")&&n("incentive_settings",j(t))};return!h||!s?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-blue-600"}),"إكمال بيانات المندوب"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.name_ar," - ",s.phone]})]}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(w,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 space-x-reverse px-6",children:y.map(t=>{const i=t.icon;return e.jsxs("button",{onClick:()=>p(t.id),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap flex items-center gap-2 ${l===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(i,{className:"w-4 h-4"}),t.name]},t.id)})})}),e.jsxs("form",{onSubmit:_,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[l==="financial"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الراتب الأساسي *"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"number",value:a.base_salary,onChange:t=>n("base_salary",t.target.value),className:`w-full pr-10 pl-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.base_salary?"border-red-300":"border-gray-300"}`,placeholder:"5000.00",step:"0.01",required:!0})]}),r.base_salary&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.base_salary})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهوية الصحيح *"}),e.jsx("input",{type:"text",value:a.national_id,onChange:t=>n("national_id",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.national_id?"border-red-300":"border-gray-300"}`,placeholder:"1234567890",required:!0}),r.national_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.national_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ التوظيف الصحيح *"}),e.jsx("input",{type:"date",value:a.hire_date,onChange:t=>n("hire_date",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.hire_date?"border-red-300":"border-gray-300"}`,required:!0}),r.hire_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.hire_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الميلاد"}),e.jsx("input",{type:"date",value:a.birth_date,onChange:t=>n("birth_date",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.birth_date?"border-red-300":"border-gray-300"}`}),r.birth_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.birth_date})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدينة"}),e.jsx("input",{type:"text",value:a.city,onChange:t=>n("city",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.city?"border-red-300":"border-gray-300"}`,placeholder:"الرياض، جدة، الدمام..."}),r.city&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.city})]})]}),l==="targets"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الهدف الشهري *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"number",value:a.monthly_target,onChange:t=>n("monthly_target",t.target.value),className:`w-full pr-10 pl-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.monthly_target?"border-red-300":"border-gray-300"}`,placeholder:"50000",step:"0.01",required:!0})]}),r.monthly_target&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.monthly_target})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الهدف الربع سنوي *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"number",value:a.quarterly_target,onChange:t=>n("quarterly_target",t.target.value),className:`w-full pr-10 pl-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.quarterly_target?"border-red-300":"border-gray-300"}`,placeholder:"150000",step:"0.01",required:!0})]}),r.quarterly_target&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.quarterly_target})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الهدف السنوي *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"number",value:a.annual_target,onChange:t=>n("annual_target",t.target.value),className:`w-full pr-10 pl-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.annual_target?"border-red-300":"border-gray-300"}`,placeholder:"600000",step:"0.01",required:!0})]}),r.annual_target&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.annual_target})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع خطة الحوافز *"}),e.jsxs("select",{value:a.incentive_plan,onChange:t=>v(t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.incentive_plan?"border-red-300":"border-gray-300"}`,required:!0,children:[e.jsx("option",{value:"fixed_commission",children:"عمولة ثابتة"}),e.jsx("option",{value:"tiered_commission",children:"عمولة متدرجة"}),e.jsx("option",{value:"target_bonus",children:"مكافآت الأهداف"})]}),r.incentive_plan&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.incentive_plan})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إعدادات الحوافز (JSON)"}),e.jsx("textarea",{value:a.incentive_settings,onChange:t=>n("incentive_settings",t.target.value),rows:8,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm ${r.incentive_settings?"border-red-300":"border-gray-300"}`,placeholder:"إعدادات الحوافز بصيغة JSON"}),r.incentive_settings&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.incentive_settings})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"خطط الحوافز الإضافية"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:g.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:`plan_${t.id}`,checked:a.incentive_plans.includes(t.id),onChange:i=>{i.target.checked?n("incentive_plans",[...a.incentive_plans,t.id]):n("incentive_plans",a.incentive_plans.filter(o=>o!==t.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:`plan_${t.id}`,className:"mr-3 text-sm text-gray-900",children:[t.name_ar,e.jsx("span",{className:"text-gray-500 text-xs block",children:t.type})]})]},t.id))})]})]}),l==="banking"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الحساب البنكي"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",value:a.bank_account,onChange:t=>n("bank_account",t.target.value),className:`w-full pr-10 pl-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.bank_account?"border-red-300":"border-gray-300"}`,placeholder:"1234567890"})]}),r.bank_account&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.bank_account})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم البنك"}),e.jsx("input",{type:"text",value:a.bank_name,onChange:t=>n("bank_name",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.bank_name?"border-red-300":"border-gray-300"}`,placeholder:"البنك الأهلي، الراجحي، سامبا..."}),r.bank_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.bank_name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الآيبان (IBAN)"}),e.jsx("input",{type:"text",value:a.iban,onChange:t=>n("iban",t.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.iban?"border-red-300":"border-gray-300"}`,placeholder:"SA0380000000608010167519"}),r.iban&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.iban})]})]}),l==="additional"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),e.jsx("textarea",{value:a.notes,onChange:t=>n("notes",t.target.value),rows:5,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r.notes?"border-red-300":"border-gray-300"}`,placeholder:"أي ملاحظات إضافية حول المندوب..."}),r.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.notes})]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 space-x-reverse p-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"إلغاء"}),e.jsxs("button",{type:"submit",disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),m?"جاري الحفظ...":"حفظ التحديثات"]})]})]})]})})}export{F as default};
