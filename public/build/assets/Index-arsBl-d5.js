import{r as g,j as e,u as U,H as X}from"./app-DLu82VbL.js";import{A as Y}from"./AdminLayout-TR3F2rdb.js";import{B as Z}from"./BarcodeManager-Ct9Z8rSQ.js";/* empty css            */const ee=({products:n=[]})=>{const[h,V]=g.useState("stock"),[o,y]=g.useState({});g.useEffect(()=>{p()},[h,n]);const p=()=>{switch(h){case"stock":_();break;case"expiry":v();break;case"profit":k();break;case"supplier":q();break}},_=()=>{const t=n.filter(r=>r.stock_quantity<=r.min_stock_level),x=n.filter(r=>r.stock_quantity===0),l=n.filter(r=>r.stock_quantity>r.min_stock_level),a=n.reduce((r,b)=>r+b.cost_price*b.stock_quantity,0),c=t.reduce((r,b)=>r+b.cost_price*b.stock_quantity,0);y({totalProducts:n.length,lowStock:t.length,outOfStock:x.length,goodStock:l.length,totalValue:a,lowStockValue:c,items:{lowStock:t,outOfStock:x,goodStock:l}})},v=()=>{const t=new Date,x=new Date;x.setDate(t.getDate()+30);const l=n.filter(r=>r.expiry_date?new Date(r.expiry_date)<t:!1),a=n.filter(r=>{if(!r.expiry_date)return!1;const b=new Date(r.expiry_date);return b>=t&&b<=x}),c=n.filter(r=>r.expiry_date?new Date(r.expiry_date)>x:!0);y({expired:l.length,expiringSoon:a.length,fresh:c.length,items:{expired:l,expiringSoon:a,fresh:c}})},k=()=>{const t=n.filter(c=>c.profit_margin>0),x=n.filter(c=>c.profit_margin<=0),l=n.reduce((c,r)=>c+r.profit_margin*r.stock_quantity,0),a=n.length>0?n.reduce((c,r)=>c+r.profit_margin,0)/n.length:0;y({profitableProducts:t.length,unprofitableProducts:x.length,totalProfitMargin:l,avgProfitMargin:a,items:{profitableProducts:t.sort((c,r)=>r.profit_margin-c.profit_margin),unprofitableProducts:x}})},q=()=>{const t={};n.forEach(l=>{const a=l.supplier_id,c=l.supplier?.name_ar||"غير محدد";t[a]||(t[a]={name:c,totalProducts:0,totalValue:0,totalProfit:0,lowStockProducts:0,products:[]}),t[a].totalProducts+=1,t[a].totalValue+=l.cost_price*l.stock_quantity,t[a].totalProfit+=l.profit_margin*l.stock_quantity,l.stock_quantity<=l.min_stock_level&&(t[a].lowStockProducts+=1),t[a].products.push(l)});const x=Object.values(t).sort((l,a)=>a.totalValue-l.totalValue);y({suppliersCount:Object.keys(t).length,suppliers:x})},f=t=>!t||isNaN(t)?"0 د.ع":new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),P=()=>{alert("سيتم إضافة تصدير Excel قريباً")},w=[{id:"stock",name:"تقرير المخزون",icon:"📦"},{id:"expiry",name:"تقرير الصلاحية",icon:"⏰"},{id:"profit",name:"تقرير الأرباح",icon:"💰"},{id:"supplier",name:"تقرير الموردين",icon:"🏢"}],D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-blue-600 text-sm font-medium",children:"إجمالي المنتجات"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:o.totalProducts})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-green-600 text-sm font-medium",children:"مخزون جيد"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:o.goodStock})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-yellow-600 text-sm font-medium",children:"مخزون منخفض"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:o.lowStock})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-red-600 text-sm font-medium",children:"نفد المخزون"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:o.outOfStock})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-indigo-600 text-sm font-medium",children:"إجمالي قيمة المخزون"}),e.jsx("div",{className:"text-xl font-bold text-indigo-900",children:f(o.totalValue)})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-orange-600 text-sm font-medium",children:"قيمة المخزون المنخفض"}),e.jsx("div",{className:"text-xl font-bold text-orange-900",children:f(o.lowStockValue)})]})]}),o.items?.lowStock?.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-yellow-50",children:e.jsx("h3",{className:"text-lg font-semibold text-yellow-900",children:"المنتجات ذات المخزون المنخفض"})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:o.items.lowStock.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-yellow-50 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name_ar}),e.jsxs("div",{className:"text-sm text-gray-600",children:["الباركود: ",t.barcode]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-yellow-700 font-medium",children:[t.stock_quantity," قطعة"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["الحد الأدنى: ",t.min_stock_level]})]})]},t.id))})})]})]}),C=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-red-600 text-sm font-medium",children:"منتهية الصلاحية"}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:o.expired})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-yellow-600 text-sm font-medium",children:"تنتهي خلال 30 يوم"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:o.expiringSoon})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-green-600 text-sm font-medium",children:"صالحة"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:o.fresh})]})]}),o.items?.expired?.length>0&&e.jsxs("div",{className:"bg-white border border-red-200 rounded-lg",children:[e.jsx("div",{className:"px-4 py-3 border-b border-red-200 bg-red-50",children:e.jsx("h3",{className:"text-lg font-semibold text-red-900",children:"منتجات منتهية الصلاحية"})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:o.items.expired.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name_ar}),e.jsxs("div",{className:"text-sm text-gray-600",children:["الباركود: ",t.barcode]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-red-700 font-medium",children:t.expiry_date}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.stock_quantity," قطعة"]})]})]},t.id))})})]})]});return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"تقارير المنتجات"}),e.jsxs("button",{onClick:P,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"تصدير Excel"]})]})}),e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"flex space-x-1 space-x-reverse bg-gray-100 p-1 rounded-lg",children:w.map(t=>e.jsxs("button",{onClick:()=>V(t.id),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium rounded-md transition-colors ${h===t.id?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("span",{children:t.icon}),t.name]},t.id))})}),e.jsxs("div",{className:"p-6",children:[h==="stock"&&D(),h==="expiry"&&C(),h==="profit"&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"تقرير الأرباح قيد التطوير..."}),h==="supplier"&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"تقرير الموردين قيد التطوير..."})]})]})};function ae({products:n,suppliers:h,categories:V,productCategories:o}){const[y,p]=g.useState(!1),[_,v]=g.useState(null),[k,q]=g.useState(!1),[f,P]=g.useState(""),[w,D]=g.useState(""),[C,t]=g.useState(""),[x,l]=g.useState(""),[a,c]=g.useState("all"),[r,b]=g.useState("all"),[j,N]=g.useState(""),{data:m,setData:i,post:I,put:E,delete:A,processing:B,errors:u,reset:S}=U({name_ar:"",name_en:"",description:"",supplier_id:"",category_id:"",barcode:"",barcode_type:"auto",cost_price:"",purchase_price:"",selling_price:"",wholesale_price:"",stock_quantity:"",min_stock_level:"",pieces_per_carton:"",piece_weight_grams:"",expiry_date:"",image:null,is_active:!0}),F=n.filter(s=>{const d=s.name_ar.toLowerCase().includes(f.toLowerCase())||s.name_en?.toLowerCase().includes(f.toLowerCase())||s.barcode?.toLowerCase().includes(f.toLowerCase()),R=!w||s.supplier_id==w,Q=!C||s.supplier?.category?.id==C,G=!x||s.category?.id==x,J=a==="all"||a==="active"&&s.is_active||a==="inactive"&&!s.is_active,K=r==="all"||r==="low"&&s.stock_quantity<=s.min_stock_level||r==="out"&&s.stock_quantity<=0||r==="normal"&&s.stock_quantity>s.min_stock_level;return d&&R&&Q&&G&&J&&K}),L=()=>{if(!j)return console.log("لم يتم اختيار مورد"),[];const s=h.find(R=>R.id==j);if(!s)return console.log("لم يتم العثور على المورد:",j),[];console.log("المورد المختار في النموذج:",s),console.log("فئات المورد - all_categories:",s.all_categories),console.log("فئات المورد - categories:",s.categories),console.log("فئات المورد - supplier_categories:",s.supplier_categories);const d=s.all_categories||s.categories||s.supplier_categories||[];return console.log("الفئات المرجعة:",d),d},H=s=>{s.preventDefault(),_?E(route("admin.products.update",_.id),{onSuccess:()=>{p(!1),v(null),N(""),S()},onError:d=>{console.log("أخطاء التحديث:",d)}}):I(route("admin.products.store"),{onSuccess:()=>{p(!1),N(""),S()},onError:d=>{console.log("أخطاء الحفظ:",d)}})},T=s=>{i({name_ar:s.name_ar,name_en:s.name_en||"",description:s.description||"",supplier_id:s.supplier_id,category_id:s.category_id||"",barcode:s.barcode||"",barcode_type:s.barcode_type||"auto",cost_price:s.cost_price||"",purchase_price:s.purchase_price||"",selling_price:s.selling_price,wholesale_price:s.wholesale_price||"",stock_quantity:s.stock_quantity||s.current_stock||0,min_stock_level:s.min_stock_level||0,pieces_per_carton:s.pieces_per_carton||"",piece_weight_grams:s.piece_weight_grams||"",expiry_date:s.expiry_date||"",image:null,is_active:s.is_active}),v(s),N(s.supplier_id),p(!0)},W=s=>{confirm("هل أنت متأكد من حذف هذا المنتج؟")&&A(route("admin.products.destroy",s.id))},$=s=>{E(route("admin.products.toggle-status",s.id),{},{preserveState:!0,preserveScroll:!0})},z=s=>{const d=s.stock_quantity||s.current_stock||0;return d<=0?"text-red-600 bg-red-50":d<=s.min_stock_level?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50"},O=s=>{const d=s.stock_quantity||s.current_stock||0;return d<=0?"نفذ المخزون":d<=s.min_stock_level?"مخزون منخفض":"متوفر"},M=s=>new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SAR"}).format(s);return e.jsxs(Y,{children:[e.jsx(X,{title:"إدارة المنتجات"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-xl sm:rounded-lg",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"إدارة المنتجات"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>q(!k),className:"bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),k?"إخفاء التقارير":"عرض التقارير"]}),e.jsx("button",{onClick:()=>{p(!0),v(null),S()},className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"إضافة منتج جديد"})]})]})}),e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"البحث (اسم، باركود...)",value:f,onChange:s=>P(s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:w,onChange:s=>D(s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع الموردين"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:x,onChange:s=>l(s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع فئات المنتجات"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:a,onChange:s=>c(s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"inactive",children:"غير نشط"})]})}),e.jsx("div",{children:e.jsxs("select",{value:r,onChange:s=>b(s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"جميع المخزون"}),e.jsx("option",{value:"normal",children:"متوفر"}),e.jsx("option",{value:"low",children:"مخزون منخفض"}),e.jsx("option",{value:"out",children:"نفذ المخزون"})]})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:F.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"h-48 bg-gray-100 relative",children:[s.image?e.jsx("img",{src:`/storage/${s.image}`,alt:s.name_ar,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"نشط":"غير نشط"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg mb-1 line-clamp-2",children:s.name_ar}),s.name_en&&e.jsx("p",{className:"text-gray-500 text-sm mb-2 line-clamp-1",children:s.name_en}),s.barcode&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:s.barcode})}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("p",{className:"text-gray-600 text-sm",children:["المورد: ",s.supplier?.name_ar]}),s.category&&e.jsxs("p",{className:"text-gray-600 text-sm",children:["الفئة: ",s.category.name_ar]})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${z(s)}`,children:[O(s)," (",s.stock_quantity||s.current_stock||0,")"]})}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"سعر البيع:"}),e.jsx("span",{className:"font-medium text-green-600",children:M(s.selling_price)})]}),s.cost_price&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"التكلفة:"}),e.jsx("span",{className:"font-medium",children:M(s.cost_price)})]}),s.profit_margin&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"الربح:"}),e.jsx("span",{className:"font-medium text-blue-600",children:M(s.profit_margin)})]})]}),s.expiry_date&&e.jsx("div",{className:"mb-3",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["انتهاء الصلاحية: ",new Date(s.expiry_date).toLocaleDateString("ar-SA")]})})]}),e.jsxs("div",{className:"px-4 pb-4 flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"تعديل",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>W(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"حذف",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("button",{onClick:()=>$(s),className:`p-2 rounded-lg transition-colors ${s.is_active?"text-red-600 hover:bg-red-50":"text-green-600 hover:bg-green-50"}`,title:s.is_active?"إلغاء التفعيل":"تفعيل",children:s.is_active?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]},s.id))}),F.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500 text-lg",children:"لا توجد منتجات تطابق المعايير المحددة"})})]})]})})}),y&&e.jsx("div",{className:"bg-white rounded-lg shadow-lg mb-6 border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:_?"تعديل المنتج":"إضافة منتج جديد"}),e.jsx("button",{type:"button",onClick:()=>{p(!1),v(null),N(""),S()},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم المنتج (عربي) *"}),e.jsx("input",{type:"text",value:m.name_ar,onChange:s=>i("name_ar",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),u.name_ar&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.name_ar})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم المنتج (إنجليزي)"}),e.jsx("input",{type:"text",value:m.name_en,onChange:s=>i("name_en",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المورد *"}),e.jsxs("select",{value:m.supplier_id,onChange:s=>{const d=s.target.value;i("supplier_id",d),N(d),i("category_id","")},className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"اختر المورد"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id))]}),u.supplier_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.supplier_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"فئة المنتج *"}),e.jsxs("select",{value:m.category_id,onChange:s=>i("category_id",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:!j,required:!0,children:[e.jsx("option",{value:"",children:j?"اختر الفئة":"اختر المورد أولاً"}),L().map(s=>e.jsx("option",{value:s.id,children:s.name_ar},s.id)),j&&L().length===0&&o.map(s=>e.jsxs("option",{value:s.id,children:[s.name_ar," (عام)"]},`fallback_${s.id}`))]}),j&&L().length===0&&o.length>0&&e.jsx("p",{className:"mt-1 text-xs text-blue-600",children:"تم عرض جميع الفئات (المورد ليس له فئات محددة)"}),j&&L().length===0&&o.length===0&&e.jsx("p",{className:"mt-1 text-xs text-amber-600",children:"لا توجد فئات منتجات متاحة"}),u.category_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.category_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(Z,{value:m.barcode,onChange:s=>i("barcode",s),showGenerator:!0,showScanner:!0,generateAutomatic:!0,label:"نظام الباركود المتقدم"}),u.barcode&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.barcode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"سعر الشراء *"}),e.jsx("input",{type:"number",step:"0.01",value:m.purchase_price,onChange:s=>i("purchase_price",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),u.purchase_price&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.purchase_price})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"سعر التكلفة"}),e.jsx("input",{type:"number",step:"0.01",value:m.cost_price,onChange:s=>i("cost_price",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"سعر البيع *"}),e.jsx("input",{type:"number",step:"0.01",value:m.selling_price,onChange:s=>i("selling_price",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),u.selling_price&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.selling_price})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"سعر الجملة"}),e.jsx("input",{type:"number",step:"0.01",value:m.wholesale_price,onChange:s=>i("wholesale_price",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الكمية المتوفرة *"}),e.jsx("input",{type:"number",value:m.stock_quantity,onChange:s=>i("stock_quantity",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الحد الأدنى للمخزون *"}),e.jsx("input",{type:"number",value:m.min_stock_level,onChange:s=>i("min_stock_level",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"عدد القطع في الكارتون"}),e.jsx("input",{type:"number",value:m.pieces_per_carton,onChange:s=>i("pieces_per_carton",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"عدد القطع في الكارتون"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"وزن القطعة (غرام)"}),e.jsx("input",{type:"number",value:m.piece_weight_grams,onChange:s=>i("piece_weight_grams",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"وزن القطعة بالغرام"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ انتهاء الصلاحية"}),e.jsx("input",{type:"date",value:m.expiry_date,onChange:s=>i("expiry_date",s.target.value),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"صورة المنتج"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>i("image",s.target.files[0]),className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),u.image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.image})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الوصف"}),e.jsx("textarea",{value:m.description,onChange:s=>i("description",s.target.value),rows:3,className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:m.is_active,onChange:s=>i("is_active",s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_active",className:"mr-2 block text-sm text-gray-900",children:"منتج نشط"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),v(null),N(""),S()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:B,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50",children:B?"جاري الحفظ...":_?"تحديث":"حفظ"})]})]})]})}),k&&e.jsx("div",{className:"mt-8",children:e.jsx(ee,{products:F})})]})}export{ae as default};
