import{j as e,r as n,H as X,a as F}from"./app-C7cjIxtJ.js";import{A as Y}from"./AdminLayout-CBAZUsRv.js";import{X as G,n as I}from"./index-DjG75rFv.js";import J from"./QuickAddForm-QfPSIRvh.js";import K from"./DetailedForm-Co9w4u1N.js";import{T as W,S as Z,P as ee,a as se}from"./triangle-alert-6oTE0uUT.js";import{P as te}from"./plus-EaxzMuIf.js";import{c as M}from"./createLucideIcon-OegKdwhO.js";import{D as ae}from"./dollar-sign-C4ryzcvL.js";import{a as re}from"./user-CWrMXrbC.js";import"./app-D2X_br3j.js";import"./target-Go6GZXUt.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ne=M("trending-up",le);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ce=M("user-check",ie);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],A=M("users",de);function oe({isOpen:a,onClose:f,onConfirm:y,title:g,message:N,isLoading:x=!1}){return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-red-100 rounded-full mr-3",children:e.jsx(W,{className:"w-5 h-5 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g||"تأكيد الحذف"})]}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:x,children:e.jsx(G,{size:20})})]}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-600 text-right",children:N||"هل أنت متأكد من رغبتك في حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء."})}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:f,disabled:x,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"إلغاء"}),e.jsx("button",{onClick:y,disabled:x,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"جاري الحذف..."]}):"حذف"})]})]})}):null}function we({representatives:a,incentivePlans:f}){const[y,g]=n.useState(!1),[N,x]=n.useState(!1),[L,w]=n.useState(null),[R,_]=n.useState(!1),[k,C]=n.useState(null),[d,$]=n.useState(""),[h,E]=n.useState("all"),[S,Q]=n.useState("name_ar"),[m,v]=n.useState(1),[i,T]=n.useState(5),[D,U]=n.useState(!1),o=n.useMemo(()=>{const t=a.filter(r=>{const l=r.name_ar?.toLowerCase().includes(d.toLowerCase())||r.name_en?.toLowerCase().includes(d.toLowerCase())||r.code?.toLowerCase().includes(d.toLowerCase())||r.email?.toLowerCase().includes(d.toLowerCase())||r.phone?.toLowerCase().includes(d.toLowerCase()),b=h==="all"||h==="active"&&r.is_active||h==="inactive"&&!r.is_active;return l&&b}).sort((r,l)=>{switch(S){case"name_ar":return(r.name_ar||"").localeCompare(l.name_ar||"");case"total_sales":return(l.total_sales||0)-(r.total_sales||0);case"customers_count":return(l.customers_count||0)-(r.customers_count||0);case"hire_date":return new Date(l.hire_date)-new Date(r.hire_date);case"base_salary":return(l.base_salary||0)-(r.base_salary||0);default:return 0}}),j=(m-1)*i,P=j+i;return{all:t,paginated:t.slice(j,P),totalPages:Math.ceil(t.length/i),totalItems:t.length}},[a,d,h,S,m,i]),c=n.useMemo(()=>{const s=a.length,t=a.filter(l=>l.is_active).length,j=a.reduce((l,b)=>l+(b.total_sales||0),0),P=a.reduce((l,b)=>l+(b.customers_count||0),0),r=s>0?j/s:0;return{total:s,active:t,inactive:s-t,totalSales:j,totalCustomers:P,avgSalesPerRep:r}},[a]),H=s=>{w(s),x(!0)},q=()=>{g(!1)},z=s=>{C(s),_(!0)},O=()=>{k&&F.delete(route("admin.sales-representatives.destroy",k.id),{onSuccess:()=>{I.success("تم حذف المندوب بنجاح"),_(!1),C(null)},onError:s=>{I.error(s.message||"حدث خطأ أثناء الحذف")}})},u=s=>new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s||0),B=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),p=s=>new Intl.NumberFormat("en-US").format(s||0),V=s=>s>=100?"text-green-600":s>=80?"text-yellow-600":"text-red-600";return e.jsxs(Y,{children:[e.jsx(X,{title:"إدارة المندوبين"}),e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-6 rounded-xl shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"لوحة تحكم مندوبي المبيعات"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"إدارة مندوبي المبيعات والحوافز"})]}),e.jsxs("button",{onClick:()=>{w(null),g(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors shadow-lg",children:[e.jsx(te,{className:"w-5 h-5"}),"إضافة مندوب جديد"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-700",children:"المندوبين"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:p(c.total)}),e.jsxs("p",{className:"text-sm text-purple-600 mt-1",children:["نشط: ",p(c.active)," | غير نشط: ",p(c.inactive)]})]}),e.jsx("div",{className:"p-3 bg-purple-200 rounded-full",children:e.jsx(A,{className:"w-8 h-8 text-purple-700"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"إجمالي المبيعات"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:u(c.totalSales)}),e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["المتوسط: ",u(c.avgSalesPerRep)]})]}),e.jsx("div",{className:"p-3 bg-blue-200 rounded-full",children:e.jsx(ne,{className:"w-8 h-8 text-blue-700"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-6 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-700",children:"العملاء"}),e.jsx("p",{className:"text-3xl font-bold text-orange-900",children:p(c.totalCustomers)}),e.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["المتوسط: ",p(Math.round(c.totalCustomers/(c.total||1)))," لكل مندوب"]})]}),e.jsx("div",{className:"p-3 bg-orange-200 rounded-full",children:e.jsx(ce,{className:"w-8 h-8 text-orange-700"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"إجمالي الأرباح"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:u(c.totalSales*.05)}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"العمولة المكتسبة"})]}),e.jsx("div",{className:"p-3 bg-green-200 rounded-full",children:e.jsx(ae,{className:"w-8 h-8 text-green-700"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"جميع المندوبين"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:i,onChange:s=>{T(Number(s.target.value)),v(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[e.jsx("option",{value:5,children:"5 في الصفحة"}),e.jsx("option",{value:10,children:"10 في الصفحة"}),e.jsx("option",{value:15,children:"15 في الصفحة"}),e.jsx("option",{value:20,children:"20 في الصفحة"}),e.jsx("option",{value:25,children:"25 في الصفحة"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"البحث في المندوبين...",value:d,onChange:s=>$(s.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("select",{value:h,onChange:s=>E(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"inactive",children:"غير نشط"})]}),e.jsxs("select",{value:S,onChange:s=>Q(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"name_ar",children:"ترتيب حسب الاسم"}),e.jsx("option",{value:"total_sales",children:"ترتيب حسب المبيعات"}),e.jsx("option",{value:"customers_count",children:"ترتيب حسب العملاء"}),e.jsx("option",{value:"hire_date",children:"ترتيب حسب تاريخ التوظيف"}),e.jsx("option",{value:"base_salary",children:"ترتيب حسب الراتب"})]})]})]}),e.jsx("div",{className:`overflow-auto border border-gray-200 rounded-lg ${i<=5?"max-h-96":i<=10?"max-h-[500px]":i<=15?"max-h-[600px]":"max-h-[700px]"}`,children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"المندوب"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"الكود"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"المبيعات"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"الأداء"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"السنة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.paginated.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-purple-500 to-blue-600 flex items-center justify-center text-white font-bold",children:s.name_ar?.charAt(0)})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.name_ar}),e.jsx("div",{className:"text-sm text-gray-500",children:s.phone})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u(s.total_sales)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`text-sm font-semibold ${V(s.annual_achievement||0)}`,children:[(s.annual_achievement||0).toFixed(0),"%"]}),e.jsx("div",{className:"ml-2 w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.annual_achievement||0)>=80?"bg-green-500":(s.annual_achievement||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.annual_achievement||0,100)}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.hire_date).getFullYear()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("button",{onClick:()=>F.get(route("admin.sales-representatives.show",s.id)),className:"text-purple-600 hover:text-purple-900 p-1 rounded transition-colors",title:"View Details",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>H(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded transition-colors",title:"Edit",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>z(s),className:"text-red-600 hover:text-red-900 p-1 rounded transition-colors",title:"Delete",children:e.jsx(se,{className:"w-4 h-4"})})]})})]},s.id))})]})}),o.totalPages>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["عرض ",(m-1)*i+1," إلى ",Math.min(m*i,o.totalItems)," من ",o.totalItems," نتيجة"]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("button",{onClick:()=>v(s=>Math.max(s-1,1)),disabled:m===1,className:"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"السابق"}),Array.from({length:o.totalPages},(s,t)=>t+1).map(s=>e.jsx("button",{onClick:()=>v(s),className:`px-3 py-2 border rounded-lg text-sm font-medium ${m===s?"bg-purple-600 text-white border-purple-600":"text-gray-700 bg-white border-gray-300 hover:bg-gray-50"}`,children:s},s)),e.jsx("button",{onClick:()=>v(s=>Math.min(s+1,o.totalPages)),disabled:m===o.totalPages,className:"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"التالي"})]})]}),o.totalItems===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"لا يوجد مندوبين"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:d||h!=="all"?"لا توجد نتائج تطابق معايير البحث":"ابدأ بإضافة مندوب جديد"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"أفضل الأداء"}),e.jsx("div",{className:"space-y-4",children:a.filter(s=>s.is_active).sort((s,t)=>(t.total_sales||0)-(s.total_sales||0)).slice(0,3).map((s,t)=>e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm ${t===0?"bg-yellow-500":t===1?"bg-gray-400":"bg-orange-600"}`,children:t+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name_ar}),e.jsx("p",{className:"text-xs text-gray-500",children:u(s.total_sales)})]}),e.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[(s.annual_achievement||0).toFixed(0),"%"]})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"إحصائيات سريعة"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"متوسط الأداء"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[(a.reduce((s,t)=>s+(t.annual_achievement||0),0)/a.length||0).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"إجمالي العمولة"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:u(a.reduce((s,t)=>s+(t.total_commission||0),0))})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"نشط هذا الشهر"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:a.filter(s=>s.is_active).length})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"النشاط الأخير"}),e.jsx("button",{onClick:()=>U(!D),className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:D?"إظهار أقل":"عرض الكل"})]}),e.jsx("div",{className:"space-y-3",children:a.slice(0,D?a.length:3).map(s=>e.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("span",{className:"font-medium",children:s.name_ar})," انضم للفريق"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:B(s.hire_date)})]})]},s.id))})]})]})]})]}),y&&e.jsx(J,{isOpen:y,onClose:()=>g(!1),onSuccess:q}),N&&e.jsx(K,{representative:L,incentivePlans:f,isOpen:N,onClose:()=>{x(!1),w(null)}}),e.jsx(oe,{isOpen:R,onClose:()=>{_(!1),C(null)},onConfirm:O,title:"حذف المندوب",message:`هل أنت متأكد من حذف المندوب "${k?.name_ar}"؟ هذا الإجراء لا يمكن التراجع عنه.`})]})}export{we as default};
