import{r as a,u as pe,j as e,H as Ue,L as Xe,b as _}from"./app-DLu82VbL.js";import{A as Ye}from"./AdminLayout-TR3F2rdb.js";/* empty css            */function et({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const tt=a.forwardRef(et);function st({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const ye=a.forwardRef(st);function rt({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const at=a.forwardRef(rt);function lt({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const be=a.forwardRef(lt);function nt({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const it=a.forwardRef(nt);function dt({title:i,titleId:x,...y},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":x},y),i?a.createElement("title",{id:x},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const ct=a.forwardRef(dt);function Ct({representative:i,products:x,currentTargets:y,multiProductPlans:b,categoryPlans:re,supplierPlans:ae}){const[q,A]=a.useState("overview"),[je,M]=a.useState(!1),[Z,G]=a.useState(null),[ot,xt]=a.useState({}),[J,D]=a.useState({}),[mt,ut]=a.useState({}),[ve,W]=a.useState(!1),[g,K]=a.useState(Array.isArray(y)?y:[]),[j,fe]=a.useState(Array.isArray(b)?b:[]),[k,Ne]=a.useState(!1),[we,V]=a.useState(""),[o,F]=a.useState({product_id:"",quantity:"",target_date:"",required_percentage:"100",product:null}),[_e,le]=a.useState({}),[H,I]=a.useState({}),[z,R]=a.useState(!1),[ke,$]=a.useState(!1),[h,U]=a.useState("selected"),[n,S]=a.useState({plan_name:"",quantity:"",target_date:"",required_percentage:"100",selected_products:[],apply_to_all:!1}),[Pe,X]=a.useState(""),[Y,E]=a.useState([]),[gt,ht]=a.useState(!1),[v,Ce]=a.useState(Array.isArray(re)?re:[]),[qe,Q]=a.useState(!1),[m,P]=a.useState({supplier_category_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""}),[ne,Se]=a.useState([]),[ie,de]=a.useState(!1),[f,Le]=a.useState(Array.isArray(ae)?ae:[]),[Ae,O]=a.useState(!1),[u,C]=a.useState({supplier_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""}),[ce,Me]=a.useState([]),[oe,xe]=a.useState(!1),{data:me,setData:ee,post:De,put:Fe,processing:ue,errors:pt,reset:te}=pe({base_salary:"",effective_date:"",is_active:!0}),{data:yt,setData:bt,post:jt,put:vt,processing:ft,errors:Nt,reset:wt}=pe({plan_name:"",start_date:"",end_date:"",notes:"",targets:[{product_id:"",target_quantity:"",required_percentage:""}]}),$e=t=>{t.preventDefault(),Z?Fe(route("admin.representatives.update-salary",[i.id,Z.id]),{onSuccess:()=>{M(!1),G(null),te()}}):De(route("admin.representatives.store-salary",i.id),{onSuccess:()=>{M(!1),te()}})},Ee=async t=>{const s=t.target.value;if(V(s),!s||s.length<2){D([]);return}try{const r=await _.get("/admin/products/search",{params:{query:s}});D(r.data)}catch(r){console.error("Error searching products:",r),D([])}},Te=t=>{F(s=>({...s,product_id:t.id,product:t})),V(t.name_ar||t.name_en||t.name),D([])},Be=async()=>{if(console.log("=== ADD TARGET CALLED ==="),console.log("newTarget:",o),!o.product_id||!o.quantity||!o.target_date){console.log("Missing required fields:",{product_id:o.product_id,quantity:o.quantity,target_date:o.target_date}),alert("يرجى إكمال جميع البيانات المطلوبة");return}R(!0);try{const t={product_id:parseInt(o.product_id),quantity:parseInt(o.quantity),target_date:o.target_date,required_percentage:parseInt(o.required_percentage)};console.log("Saving target:",t);const s=await _.post(`/admin/representatives/${i.id}/targets`,{targets:[t]});console.log("Target saved successfully:",s.data);const r={id:Date.now(),product_id:o.product_id,quantity:parseInt(o.quantity),target_date:o.target_date,required_percentage:parseInt(o.required_percentage),achievement_percentage:0,achieved_quantity:0,is_achieved:!1,product:o.product};K(d=>[...d,r]),F({product_id:"",quantity:"",target_date:"",required_percentage:"100",product:null}),V(""),D([]),W(!1),alert("✅ تم حفظ الهدف بنجاح! سيتم تحديث الصفحة..."),setTimeout(()=>{window.location.reload()},2e3)}catch(t){console.error("Error saving target:",t),alert("❌ حدث خطأ أثناء حفظ الهدف: "+(t.response?.data?.message||t.message))}finally{R(!1)}},We=t=>{K(s=>s.filter(r=>r.id!==t))},T=(t,s,r)=>{K(d=>d.map(c=>c.id===t||c===t?{...c,[s]:r}:c))},Ve=async(t,s)=>{if(le(r=>({...r,[t]:s})),!s||s.length<2){I(r=>({...r,[t]:[]}));return}try{const r=await _.get("/admin/products/search",{params:{query:s}});I(d=>({...d,[t]:r.data}))}catch(r){console.error("Error searching products:",r),I(d=>({...d,[t]:[]}))}},He=(t,s)=>{T(t,"product_id",s.id),T(t,"product",s),le(r=>({...r,[t]:s.name_ar||s.name_en||s.name})),I(r=>({...r,[t]:[]}))},Ie=async t=>{const s=t.target.value;if(X(s),!s||s.length<2){E([]);return}try{const r=await _.get("/admin/products/search",{params:{query:s}});E(r.data)}catch(r){console.error("Error searching products:",r),E([])}},ze=t=>{n.selected_products.some(r=>r.id===t.id)||S(r=>({...r,selected_products:[...r.selected_products,t]})),X(""),E([])},Re=t=>{S(s=>({...s,selected_products:s.selected_products.filter(r=>r.id!==t)}))},se=()=>{S({plan_name:"",quantity:"",target_date:"",required_percentage:"100",selected_products:[],apply_to_all:!1}),X(""),E([]),U("selected")},Qe=async()=>{if(console.log("Current multiPlanData:",n),console.log("Plan type:",h),!n.plan_name){alert("يرجى إدخال اسم الخطة");return}if(!n.quantity){alert("يرجى إدخال الكمية المطلوبة");return}if(!n.target_date){alert("يرجى اختيار التاريخ المستهدف");return}if(!n.required_percentage){alert("يرجى إدخال النسبة المطلوبة");return}if(h==="selected"&&n.selected_products.length===0){alert("يرجى اختيار منتج واحد على الأقل");return}if(isNaN(parseInt(n.quantity))||parseInt(n.quantity)<=0){alert("يرجى إدخال كمية صحيحة");return}if(isNaN(parseInt(n.required_percentage))||parseInt(n.required_percentage)<=0||parseInt(n.required_percentage)>100){alert("يرجى إدخال نسبة صحيحة بين 1 و 100");return}R(!0);try{let t=n.selected_products;if(h==="all"&&(console.log("Fetching all products..."),t=(await _.get("/admin/products/search",{params:{all:!0}})).data,console.log("Fetched products:",t.length),t.length===0)){alert("❌ لا توجد منتجات نشطة في النظام");return}const s={plan_name:n.plan_name,total_target_quantity:parseInt(n.quantity),required_percentage:parseInt(n.required_percentage),start_date:new Date().toISOString().split("T")[0],end_date:n.target_date,product_ids:Array.isArray(t)?t.map(d=>d.id):[],notes:`خطة ${h==="all"?"جميع المنتجات":"منتجات مختارة"} - ${Array.isArray(t)?t.length:0} منتج`};if(console.log("Creating multi-product plan:",s),console.log("Product IDs:",s.product_ids),s.product_ids.length===0){alert("❌ لا توجد منتجات محددة للخطة");return}const r=await _.post(`/admin/representatives/${i.id}/multi-product-plans`,s);r.data.success?(alert(`✅ تم إنشاء الخطة متعددة المنتجات بنجاح مع ${t.length} منتج!`),fe(d=>[r.data.plan,...d]),se(),$(!1),setTimeout(()=>{window.location.reload()},1500)):alert("❌ حدث خطأ في إنشاء الخطة")}catch(t){console.error("Error saving multi-plan:",t);const s=t.response?.data?.message||t.response?.data?.errors||t.message;alert("❌ حدث خطأ أثناء حفظ الخطة: "+(typeof s=="object"?JSON.stringify(s):s))}finally{R(!1)}},Oe=()=>{let t=0,s=0;if(Array.isArray(g)&&g.length>0){const d=g.filter(c=>{const p=parseFloat(c?.achievement_percentage||0);return c&&!isNaN(p)});if(d.length>0){const c=d.reduce((p,L)=>p+parseFloat(L.achievement_percentage||0),0);t+=c,s+=d.length}}if(Array.isArray(j)&&j.length>0){const d=j.filter(c=>{const p=parseFloat(c?.completion_percentage||0);return c&&!isNaN(p)});if(d.length>0){const c=d.reduce((p,L)=>p+parseFloat(L.completion_percentage||0),0);t+=c,s+=d.length}}if(Array.isArray(v)&&v.length>0){const d=v.filter(c=>{const p=parseFloat(c?.achievement_percentage||0);return c&&!isNaN(p)});if(d.length>0){const c=d.reduce((p,L)=>p+parseFloat(L.achievement_percentage||0),0);t+=c,s+=d.length}}if(Array.isArray(f)&&f.length>0){const d=f.filter(c=>{const p=parseFloat(c?.achievement_percentage||0);return c&&!isNaN(p)});if(d.length>0){const c=d.reduce((p,L)=>p+parseFloat(L.achievement_percentage||0),0);t+=c,s+=d.length}}return s===0?0:Math.round(t/s)},Ze=()=>{const t={individualTargets:{total:0,achieved:0,inProgress:0,expired:0},multiProductPlans:{total:0,achieved:0,inProgress:0,expired:0},categoryPlans:{total:0,achieved:0,inProgress:0,expired:0},supplierPlans:{total:0,achieved:0,inProgress:0,expired:0}};return Array.isArray(g)&&(t.individualTargets.total=g.length,g.forEach(s=>{s.is_achieved?t.individualTargets.achieved++:new Date(s.target_date)<new Date?t.individualTargets.expired++:t.individualTargets.inProgress++})),Array.isArray(j)&&(t.multiProductPlans.total=j.length,j.forEach(s=>{s.status==="completed"?t.multiProductPlans.achieved++:s.status==="expired"?t.multiProductPlans.expired++:t.multiProductPlans.inProgress++})),Array.isArray(v)&&(t.categoryPlans.total=v.length,v.forEach(s=>{s.status==="completed"?t.categoryPlans.achieved++:new Date(s.end_date)<new Date?t.categoryPlans.expired++:t.categoryPlans.inProgress++})),Array.isArray(f)&&(t.supplierPlans.total=f.length,f.forEach(s=>{s.status==="completed"?t.supplierPlans.achieved++:new Date(s.end_date)<new Date?t.supplierPlans.expired++:t.supplierPlans.inProgress++})),t},w=Oe(),B=w>=80?"green":w>=50?"yellow":"red",l=Ze(),N=i.salaries?.find(t=>t.is_active);i.salary_plans?.filter(t=>t.is_active),i.salary_plans?.filter(t=>!t.is_active);const ge=async()=>{try{const t=await _.get("/admin/api/supplier-categories");Se(t.data.categories||t.data)}catch(t){console.error("Error loading supplier categories:",t)}},Ge=async()=>{if(!m.supplier_category_id||!m.plan_name||!m.target_quantity||!m.start_date||!m.end_date){alert("يرجى إكمال جميع البيانات المطلوبة");return}de(!0);try{const t=await _.post(`/admin/representatives/${i.id}/category-plans`,{supplier_category_id:parseInt(m.supplier_category_id),plan_name:m.plan_name,target_quantity:parseInt(m.target_quantity),required_percentage:parseInt(m.required_percentage),start_date:m.start_date,end_date:m.end_date});t.data.success&&(alert("✅ تم إنشاء خطة القسم بنجاح!"),Ce(s=>[t.data.categoryPlan,...s]),P({supplier_category_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""}),Q(!1))}catch(t){console.error("Error creating category plan:",t),alert("حدث خطأ في إنشاء خطة القسم")}finally{de(!1)}},he=async()=>{try{const t=await _.get("/admin/suppliers-list");Me(t.data.suppliers||t.data)}catch(t){console.error("Error loading suppliers:",t)}},Je=async()=>{if(!u.supplier_id||!u.plan_name||!u.target_quantity||!u.start_date||!u.end_date){alert("يرجى إكمال جميع البيانات المطلوبة");return}xe(!0);try{const t=await _.post(`/admin/representatives/${i.id}/supplier-plans`,{supplier_id:parseInt(u.supplier_id),plan_name:u.plan_name,target_quantity:parseInt(u.target_quantity),required_percentage:parseInt(u.required_percentage),start_date:u.start_date,end_date:u.end_date});t.data.success&&(alert("✅ تم إنشاء خطة المورد بنجاح!"),Le(s=>[t.data.supplierPlan,...s]),C({supplier_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""}),O(!1))}catch(t){console.error("Error creating supplier plan:",t),alert("حدث خطأ في إنشاء خطة المورد")}finally{xe(!1)}},Ke=t=>t?.split(" ").map(s=>s[0]).join("").slice(0,2)||"";return e.jsxs(Ye,{children:[e.jsx(Ue,{title:`ملف ${i.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Xe,{href:route("admin.representatives.index"),className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200",children:e.jsx(tt,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-lg",children:Ke(i.name)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:i.phone})]})]}),e.jsx("div",{className:"mr-auto",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${i.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i.is_active?"نشط":"غير نشط"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-100 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-100 text-blue-600",children:e.jsx(be,{className:"w-7 h-7"})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"الراتب الحالي"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:N?`${parseFloat(N.base_salary).toLocaleString()}`:"0"}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"دينار عراقي"})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-100 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-xl ${B==="green"?"bg-green-100 text-green-600":B==="yellow"?"bg-yellow-100 text-yellow-600":B==="red"?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:e.jsx(at,{className:"w-7 h-7"})}),e.jsxs("div",{className:"mr-4 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"مستوى الإنجاز العام"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[w,"%"]}),g.length>0&&e.jsx("div",{className:"flex-1 max-w-24",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${B==="green"?"bg-green-500":B==="yellow"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(w,100)}%`}})})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g.length>0?`متوسط ${g.length} ${g.length===1?"هدف":"أهداف"} • ${g.filter(t=>t.is_achieved).length} مُنجز`:"لا توجد أهداف محددة"})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-100 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-xl bg-purple-100 text-purple-600",children:e.jsx(ye,{className:"w-7 h-7"})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"إجمالي الخطط"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:l.individualTargets.total+l.multiProductPlans.total+l.categoryPlans.total+l.supplierPlans.total}),e.jsxs("p",{className:"text-xs text-purple-600 mt-1",children:[l.individualTargets.achieved+l.multiProductPlans.achieved+l.categoryPlans.achieved+l.supplierPlans.achieved," مُنجز |",l.individualTargets.inProgress+l.multiProductPlans.inProgress+l.categoryPlans.inProgress+l.supplierPlans.inProgress," قيد التنفيذ"]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-100 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-xl bg-orange-100 text-orange-600",children:e.jsx(ye,{className:"w-7 h-7"})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"تاريخ الاستحقاق"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:N?new Date(N.effective_date).toLocaleDateString("en-GB"):"غير محدد"}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"تاريخ السريان"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 space-x-reverse px-6",children:[e.jsx("button",{onClick:()=>A("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${q==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"نظرة عامة"}),e.jsx("button",{onClick:()=>A("salary"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${q==="salary"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"الراتب والبدلات"}),e.jsx("button",{onClick:()=>A("plans"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${q==="plans"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"الخطط والأهداف"})]})}),e.jsxs("div",{className:"p-6",children:[q==="overview"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"ملخص الأداء العام"})]}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:[w,"% متوسط الإنجاز"]})]})}),e.jsxs("div",{className:"p-6",children:[(g.length>0||j.length>0||v.length>0||f.length>0)&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"التقدم الإجمالي - جميع الخطط"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["إجمالي ",l.individualTargets.total+l.multiProductPlans.total+l.categoryPlans.total+l.supplierPlans.total," خطة/هدف"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:e.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${w>=80?"bg-gradient-to-r from-green-500 to-green-600":w>=50?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-red-500 to-red-600"}`,style:{width:`${Math.min(w,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-4",children:[e.jsxs("span",{children:["نسبة الإنجاز الإجمالية: ",w,"%"]}),e.jsxs("span",{children:["متبقي: ",Math.max(100-w,0),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.individualTargets.total>0&&e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"أهداف فردية"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.individualTargets.total}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"text-green-600",children:["✓ ",l.individualTargets.achieved]})," |",e.jsxs("span",{className:"text-yellow-600",children:[" ⏳ ",l.individualTargets.inProgress]})," |",e.jsxs("span",{className:"text-red-600",children:[" ⚠ ",l.individualTargets.expired]})]})]}),l.multiProductPlans.total>0&&e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-200",children:[e.jsx("div",{className:"text-xs font-semibold text-purple-600 mb-1",children:"خطط متعددة"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.multiProductPlans.total}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"text-green-600",children:["✓ ",l.multiProductPlans.achieved]})," |",e.jsxs("span",{className:"text-yellow-600",children:[" ⏳ ",l.multiProductPlans.inProgress]})," |",e.jsxs("span",{className:"text-red-600",children:[" ⚠ ",l.multiProductPlans.expired]})]})]}),l.categoryPlans.total>0&&e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-orange-200",children:[e.jsx("div",{className:"text-xs font-semibold text-orange-600 mb-1",children:"خطط الأقسام"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.categoryPlans.total}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"text-green-600",children:["✓ ",l.categoryPlans.achieved]})," |",e.jsxs("span",{className:"text-yellow-600",children:[" ⏳ ",l.categoryPlans.inProgress]})," |",e.jsxs("span",{className:"text-red-600",children:[" ⚠ ",l.categoryPlans.expired]})]})]}),l.supplierPlans.total>0&&e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-xs font-semibold text-green-600 mb-1",children:"خطط الموردين"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:l.supplierPlans.total}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"text-green-600",children:["✓ ",l.supplierPlans.achieved]})," |",e.jsxs("span",{className:"text-yellow-600",children:[" ⏳ ",l.supplierPlans.inProgress]})," |",e.jsxs("span",{className:"text-red-600",children:[" ⚠ ",l.supplierPlans.expired]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>{A("plans"),W(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة هدف جديد"]}),e.jsxs("button",{onClick:()=>{A("plans"),$(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"إضافة خطة متعددة"]}),e.jsxs("button",{onClick:()=>A("plans"),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"عرض جميع الأهداف"]})]})]})]})}),q==="salary"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"إدارة الراتب والبدلات"}),e.jsxs("button",{onClick:()=>M(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200 flex items-center gap-2",children:[e.jsx(ct,{className:"w-5 h-5"}),"إضافة راتب"]})]}),N?e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"الراتب الحالي النشط"}),e.jsx("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:"نشط"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"المبلغ الأساسي"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:parseFloat(N.base_salary).toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"دينار عراقي"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"تاريخ الاستحقاق"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Date(N.effective_date).toLocaleDateString("en-GB")}),e.jsx("p",{className:"text-xs text-gray-500",children:"تاريخ السريان"})]})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:e.jsxs("button",{onClick:()=>{G(N),ee({base_salary:N.base_salary,effective_date:N.effective_date,is_active:N.is_active}),M(!0)},className:"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50 px-3 py-2 rounded-lg transition duration-200 flex items-center gap-1",children:[e.jsx(it,{className:"w-4 h-4"}),"تعديل الراتب"]})})]}):e.jsxs("div",{className:"bg-gray-50 rounded-xl p-12 text-center",children:[e.jsx(be,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"لا يوجد راتب محدد لهذا المندوب"}),e.jsx("button",{onClick:()=>M(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:"تحديد راتب أساسي"})]})]}),q==="plans"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"خطط الأهداف"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"إدارة خطط المبيعات والأهداف"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"إضافة هدف فردي"]}),e.jsxs("button",{onClick:()=>$(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"إضافة خطة متعددة المنتجات"]}),e.jsxs("button",{onClick:()=>{Q(!0),ge()},className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"إضافة خطة حسب القسم"]}),e.jsxs("button",{onClick:()=>{O(!0),he()},className:"flex items-center gap-2 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M8 11v6h8v-6M8 11H6a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2v-6a2 2 0 00-2-2h-2"})}),"إضافة خطة حسب المورد"]})]})]})}),e.jsxs("div",{className:"p-6",children:[ve&&e.jsxs("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-6 mb-8 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"🎯 إضافة هدف جديد"}),e.jsx("button",{onClick:()=>{W(!1),F({product_id:"",quantity:"",target_date:"",required_percentage:"100",product:null}),V(""),D([])},className:"text-gray-500 hover:text-gray-700 bg-white rounded-full p-2 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"relative z-50",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"اختيار المنتج"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:we,onChange:Ee,placeholder:"ابحث عن منتج...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 shadow-sm"}),Array.isArray(J)&&J.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-2xl mt-2 z-[100] max-h-80 overflow-y-auto",children:J.map(t=>e.jsxs("div",{onClick:()=>Te(t),className:"px-4 py-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.name_ar||t.name_en||t.name}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["الباركود: ",t.barcode||"غير محدد"]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["المورد: ",t.supplier?.name_ar||t.supplier?.name_en||t.supplier?.name||"غير محدد"]})]},t.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"الكمية المطلوبة"}),e.jsx("input",{type:"number",value:o.quantity,onChange:t=>F(s=>({...s,quantity:t.target.value})),placeholder:"أدخل الكمية",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"النسبة المطلوبة للإنجاز (%)"}),e.jsx("input",{type:"number",value:o.required_percentage,onChange:t=>F(s=>({...s,required_percentage:t.target.value})),placeholder:"100",min:"1",max:"100",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"التاريخ المستهدف"}),e.jsx("input",{type:"date",value:o.target_date,onChange:t=>F(s=>({...s,target_date:t.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:Be,disabled:!o.product_id||!o.quantity||!o.target_date||!o.required_percentage||z,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition duration-200 font-medium shadow-sm flex items-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),e.jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"opacity-75"})]}),"جاري الحفظ..."]}):e.jsx(e.Fragment,{children:"✅ إضافة وحفظ الهدف"})})})]}),ke&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"📊"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"إضافة خطة متعددة المنتجات"}),e.jsx("p",{className:"text-sm text-gray-600",children:"إنشاء خطة موحدة لعدة منتجات أو جميع المنتجات"})]})]}),e.jsx("button",{onClick:()=>{$(!1),se()},className:"text-gray-500 hover:text-gray-700 bg-white rounded-full p-2 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"نوع الخطة"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{onClick:()=>U("selected"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${h==="selected"?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${h==="selected"?"bg-green-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"منتجات مختارة"}),e.jsx("p",{className:"text-sm text-gray-600",children:"اختيار منتجات محددة للخطة"})]})]})}),e.jsx("div",{onClick:()=>U("all"),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${h==="all"?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${h==="all"?"bg-green-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"جميع المنتجات"}),e.jsx("p",{className:"text-sm text-gray-600",children:"تطبيق الخطة على كافة المنتجات"})]})]})})]})]}),h==="selected"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"اختيار المنتجات"}),n.selected_products.length>0&&e.jsxs("div",{className:"mb-4 bg-blue-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 mb-3",children:["المنتجات المختارة (",n.selected_products.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:n.selected_products.map(t=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name_ar||t.name_en||t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["الباركود: ",t.barcode||"غير محدد"]})]}),e.jsx("button",{onClick:()=>Re(t.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t.id))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Pe,onChange:Ie,placeholder:"ابحث عن منتج لإضافته...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-gray-900 shadow-sm"}),Array.isArray(Y)&&Y.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-2xl mt-2 z-[100] max-h-60 overflow-y-auto",children:Y.map(t=>e.jsxs("div",{onClick:()=>ze(t),className:"px-4 py-3 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:t.name_ar||t.name_en||t.name}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["الباركود: ",t.barcode||"غير محدد"]}),e.jsxs("div",{className:"text-sm text-green-600",children:["المورد: ",t.supplier?.name_ar||t.supplier?.name_en||t.supplier?.name||"غير محدد"]})]},t.id))})]})]}),(h==="all"||h==="selected"&&n.selected_products.length>0)&&e.jsxs("div",{className:"space-y-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"اسم الخطة"}),e.jsx("input",{type:"text",value:n.plan_name,onChange:t=>S(s=>({...s,plan_name:t.target.value})),placeholder:"أدخل اسم الخطة",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"الكمية المطلوبة لكل منتج"}),e.jsx("input",{type:"number",value:n.quantity,onChange:t=>S(s=>({...s,quantity:t.target.value})),placeholder:"أدخل الكمية",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"النسبة المطلوبة للإنجاز (%)"}),e.jsx("input",{type:"number",value:n.required_percentage,onChange:t=>S(s=>({...s,required_percentage:t.target.value})),placeholder:"100",min:"1",max:"100",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"التاريخ المستهدف"}),e.jsx("input",{type:"date",value:n.target_date,onChange:t=>S(s=>({...s,target_date:t.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm"})]})]})]}),(h==="all"||h==="selected"&&n.selected_products.length>0)&&e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold text-yellow-900 mb-2",children:"ملخص الخطة"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsxs("p",{children:["• اسم الخطة: ",n.plan_name||"غير محدد"]}),e.jsxs("p",{children:["• نوع الخطة: ",h==="all"?"جميع المنتجات":`${n.selected_products.length} منتج مختار`]}),e.jsxs("p",{children:["• الكمية لكل منتج: ",n.quantity||"غير محددة"]}),e.jsxs("p",{children:["• النسبة المطلوبة: ",n.required_percentage||"غير محددة","%"]}),e.jsxs("p",{children:["• التاريخ المستهدف: ",n.target_date||"غير محدد"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{$(!1),se()},className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-200 font-medium",children:"إلغاء"}),e.jsx("button",{onClick:Qe,disabled:!n.quantity||!n.target_date||!n.required_percentage||h==="selected"&&n.selected_products.length===0||z,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition duration-200 font-medium shadow-sm flex items-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),e.jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"opacity-75"})]}),"جاري إنشاء الخطة..."]}):e.jsx(e.Fragment,{children:"📊 إنشاء الخطة"})})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"🎯"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"الأهداف الحالية"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.length," هدف مُحدد"]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:()=>Ne(!k),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition duration-200 font-medium ${k?"bg-gray-200 text-gray-800 hover:bg-gray-300":"bg-blue-600 text-white hover:bg-blue-700"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"إلغاء التعديل"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"تعديل الأهداف"]})})})]}),g.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المنتج"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية المطلوبة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"النسبة المطلوبة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التاريخ المستهدف"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإنجاز"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),k&&e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(g)&&g.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k?e.jsxs("div",{className:"relative z-40 min-w-48",children:[e.jsx("input",{type:"text",value:_e[t.id||s]||t.product?.name_ar||t.product?.name_en||t.product?.name||"",onChange:r=>Ve(t.id||s,r.target.value),placeholder:"ابحث عن منتج...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),H[t.id||s]&&Array.isArray(H[t.id||s])&&H[t.id||s].length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-2xl mt-1 z-[60] max-h-60 overflow-y-auto",children:H[t.id||s].map(r=>e.jsxs("div",{onClick:()=>He(t.id||s,r),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.name_ar||r.name_en||r.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["الباركود: ",r.barcode||"غير محدد"]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["المورد: ",r.supplier?.name_ar||r.supplier?.name_en||r.supplier?.name||"غير محدد"]})]},r.id))})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"📦"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.product?.name_ar||t.product?.name_en||t.product?.name||"منتج غير محدد"}),t.product?.supplier&&e.jsxs("div",{className:"text-sm text-gray-500",children:["المورد: ",t.product.supplier.name_ar||t.product.supplier.name_en||t.product.supplier.name]}),t.product?.barcode&&e.jsxs("div",{className:"text-xs text-gray-400",children:["الباركود: ",t.product.barcode]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k?e.jsx("input",{type:"number",value:t.quantity,onChange:r=>T(t.id||s,"quantity",r.target.value),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[t.quantity?.toLocaleString()||"0"," وحدة"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k?e.jsx("input",{type:"number",value:t.required_percentage||"100",onChange:r=>T(t.id||s,"required_percentage",r.target.value),min:"1",max:"100",className:"w-16 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[t.required_percentage||"100","%"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k?e.jsx("input",{type:"date",value:t.target_date,onChange:r=>T(t.id||s,"target_date",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):e.jsx("span",{className:"text-sm text-gray-900",children:t.target_date?new Date(t.target_date).toLocaleDateString("ar-IQ"):"غير محدد"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[parseFloat(t.achievement_percentage||0).toFixed(0),"%"]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(parseFloat(t.achievement_percentage||0),100)}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[t.achieved_quantity||0," / ",t.quantity?.toLocaleString()||"0"]})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${t.is_achieved?"bg-green-100 text-green-800":new Date(t.target_date)<new Date?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.is_achieved?"مُحقق ✅":new Date(t.target_date)<new Date?"منتهي ⚠️":"قيد التنفيذ 🔄"})}),k&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>We(t.id||s),className:"text-red-600 hover:text-red-900 transition-colors flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"حذف"]})})]},t.id||s))})]})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد أهداف حالياً"}),e.jsx("p",{className:"text-gray-600",children:"ابدأ بإضافة هدف جديد لبناء خطة مبيعاتك"})]})]})]})]}),q==="overview"&&e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"الخطط متعددة المنتجات"})]}),e.jsxs("span",{className:"bg-purple-100 text-purple-800 text-sm font-medium px-3 py-1 rounded-full",children:[j?.length||0," خطة"]})]})}),j&&j.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"اسم الخطة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"عدد المنتجات"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية المستهدفة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية المحققة"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نسبة الإنجاز"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفترة الزمنية"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(j)&&j.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.plan_name}),t.notes&&e.jsx("div",{className:"text-xs text-gray-400 max-w-xs truncate",children:t.notes})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[t.plan_products?.length||0," منتج"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.total_target_quantity?.toLocaleString()||"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-green-600",children:t.achieved_quantity?.toLocaleString()||"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-full max-w-[120px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[parseFloat(t.achievement_percentage||0).toFixed(1),"%"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.required_percentage,"% مطلوب"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${parseFloat(t.achievement_percentage||0)>=parseFloat(t.required_percentage||100)?"bg-gradient-to-r from-green-500 to-green-600":parseFloat(t.achievement_percentage||0)>=50?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-red-500 to-red-600"}`,style:{width:`${Math.min(parseFloat(t.achievement_percentage||0),100)}%`}})})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{children:["من: ",t.start_date?new Date(t.start_date).toLocaleDateString("ar-IQ"):"غير محدد"]}),e.jsxs("div",{children:["إلى: ",t.end_date?new Date(t.end_date).toLocaleDateString("ar-IQ"):"غير محدد"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${t.status==="active"?"bg-green-100 text-green-800":t.status==="completed"?"bg-blue-100 text-blue-800":t.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="active"?"نشط":t.status==="completed"?"مكتمل":t.status==="paused"?"متوقف":"ملغي"})})]},t.id||s))})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"تفاصيل المنتجات في الخطط:"}),e.jsx("div",{className:"space-y-3",children:Array.isArray(j)&&j.map((t,s)=>e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer list-none",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-purple-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-600 font-medium",children:t.plan_name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.plan_products?.length||0," منتج)"]})]}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})}),e.jsx("div",{className:"mt-2 p-3 bg-white rounded-lg border border-gray-200",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Array.isArray(t.plan_products)&&t.plan_products.map((r,d)=>e.jsxs("div",{className:"bg-gray-50 rounded-md p-3 border border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800 mb-1",children:r.product?.name_ar||r.product?.name_en||r.product?.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:["محقق: ",r.achieved_quantity||0," من إجمالي الخطة"]}),r.product?.supplier&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["المورد: ",r.product.supplier.name_ar||r.product.supplier.name_en||r.product.supplier.name]})]},d))})})]},t.id||s))})]})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد خطط متعددة المنتجات"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"ابدأ بإضافة أول خطة متعددة المنتجات لتحقيق أهداف أكبر"}),e.jsxs("button",{onClick:()=>$(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2 mx-auto",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة أول خطة"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"خطط الأقسام"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"إدارة أهداف البيع حسب أقسام المنتجات"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[v.length," خطة"]})]})}),v&&v.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"اسم الخطة"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"القسم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الهدف المطلوب"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التقدم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفترة الزمنية"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(v)&&v.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.plan_name})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.supplier_category?.name_ar||"غير محدد"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.supplier_category?.name_en||""})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.target_quantity}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.required_percentage,"% مطلوب"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-full max-w-[120px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[parseFloat(t.achievement_percentage||0).toFixed(1),"%"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.achieved_quantity||0,"/",t.target_quantity]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${parseFloat(t.achievement_percentage||0)>=parseFloat(t.required_percentage||100)?"bg-gradient-to-r from-green-500 to-green-600":parseFloat(t.achievement_percentage||0)>=50?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-red-500 to-red-600"}`,style:{width:`${Math.min(parseFloat(t.achievement_percentage||0),100)}%`}})})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{children:["من: ",t.start_date?new Date(t.start_date).toLocaleDateString("ar-IQ"):"غير محدد"]}),e.jsxs("div",{children:["إلى: ",t.end_date?new Date(t.end_date).toLocaleDateString("ar-IQ"):"غير محدد"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${t.status==="active"?"bg-green-100 text-green-800":t.status==="completed"?"bg-blue-100 text-blue-800":t.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="active"?"نشط":t.status==="completed"?"مكتمل":t.status==="paused"?"متوقف":"ملغي"})})]},t.id||s))})]})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد خطط أقسام"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"ابدأ بإضافة أول خطة حسب قسم المنتجات"}),e.jsxs("button",{onClick:()=>{Q(!0),ge()},className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2 mx-auto",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة أول خطة قسم"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"خطط الموردين"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"إدارة أهداف البيع حسب الموردين المحددين"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[f.length," خطة"]})]})}),f&&f.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"اسم الخطة"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المورد"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الهدف المطلوب"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التقدم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفترة الزمنية"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(f)&&f.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.plan_name})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.supplier?.name_ar||"غير محدد"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.supplier?.name_en||""})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.target_quantity}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.required_percentage,"% مطلوب"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-full max-w-[120px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[parseFloat(t.achievement_percentage||0).toFixed(1),"%"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.achieved_quantity||0,"/",t.target_quantity]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${parseFloat(t.achievement_percentage||0)>=parseFloat(t.required_percentage||100)?"bg-gradient-to-r from-green-500 to-green-600":parseFloat(t.achievement_percentage||0)>=50?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-red-500 to-red-600"}`,style:{width:`${Math.min(parseFloat(t.achievement_percentage||0),100)}%`}})})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{children:["من: ",t.start_date?new Date(t.start_date).toLocaleDateString("ar-IQ"):"غير محدد"]}),e.jsxs("div",{children:["إلى: ",t.end_date?new Date(t.end_date).toLocaleDateString("ar-IQ"):"غير محدد"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${t.status==="active"?"bg-green-100 text-green-800":t.status==="completed"?"bg-blue-100 text-blue-800":t.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="active"?"نشط":t.status==="completed"?"مكتمل":t.status==="paused"?"متوقف":"ملغي"})})]},t.id||s))})]})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M8 11v6h8v-6M8 11H6a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2v-6a2 2 0 00-2-2h-2"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد خطط موردين"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"ابدأ بإضافة أول خطة حسب مورد محدد"}),e.jsxs("button",{onClick:()=>{O(!0),he()},className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2 mx-auto",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"إضافة أول خطة مورد"]})]})]})]}),qe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"إضافة خطة حسب القسم"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"القسم"}),e.jsxs("select",{value:m.supplier_category_id,onChange:t=>P(s=>({...s,supplier_category_id:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0,children:[e.jsx("option",{value:"",children:"اختر القسم"}),Array.isArray(ne)&&ne.map(t=>e.jsxs("option",{value:t.id,children:[t.name_ar," - ",t.name_en]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الخطة"}),e.jsx("input",{type:"text",value:m.plan_name,onChange:t=>P(s=>({...s,plan_name:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"أدخل اسم الخطة",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الكمية المطلوبة"}),e.jsx("input",{type:"number",value:m.target_quantity,onChange:t=>P(s=>({...s,target_quantity:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"أدخل الكمية",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"النسبة المطلوبة (%)"}),e.jsx("input",{type:"number",min:"1",max:"100",value:m.required_percentage,onChange:t=>P(s=>({...s,required_percentage:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ البداية"}),e.jsx("input",{type:"date",value:m.start_date,onChange:t=>P(s=>({...s,start_date:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ النهاية"}),e.jsx("input",{type:"date",value:m.end_date,onChange:t=>P(s=>({...s,end_date:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsx("button",{onClick:Ge,disabled:ie,className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition duration-200 disabled:opacity-50",children:ie?"جاري الحفظ...":"حفظ الخطة"}),e.jsx("button",{onClick:()=>{Q(!1),P({supplier_category_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""})},className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg hover:bg-gray-300 transition duration-200",children:"إلغاء"})]})]})})}),Ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"إضافة خطة حسب المورد"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المورد"}),e.jsxs("select",{value:u.supplier_id,onChange:t=>C(s=>({...s,supplier_id:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0,children:[e.jsx("option",{value:"",children:"اختر المورد"}),Array.isArray(ce)&&ce.map(t=>e.jsxs("option",{value:t.id,children:[t.name_ar," - ",t.name_en]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الخطة"}),e.jsx("input",{type:"text",value:u.plan_name,onChange:t=>C(s=>({...s,plan_name:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"أدخل اسم الخطة",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الكمية المطلوبة"}),e.jsx("input",{type:"number",value:u.target_quantity,onChange:t=>C(s=>({...s,target_quantity:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"أدخل الكمية",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"النسبة المطلوبة (%)"}),e.jsx("input",{type:"number",min:"1",max:"100",value:u.required_percentage,onChange:t=>C(s=>({...s,required_percentage:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ البداية"}),e.jsx("input",{type:"date",value:u.start_date,onChange:t=>C(s=>({...s,start_date:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ النهاية"}),e.jsx("input",{type:"date",value:u.end_date,onChange:t=>C(s=>({...s,end_date:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsx("button",{onClick:Je,disabled:oe,className:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition duration-200 disabled:opacity-50",children:oe?"جاري الحفظ...":"حفظ الخطة"}),e.jsx("button",{onClick:()=>{O(!1),C({supplier_id:"",plan_name:"",target_quantity:"",required_percentage:"100",start_date:"",end_date:""})},className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg hover:bg-gray-300 transition duration-200",children:"إلغاء"})]})]})})}),je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:Z?"تعديل الراتب":"إضافة راتب جديد"}),e.jsxs("form",{onSubmit:$e,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المبلغ الأساسي"}),e.jsx("input",{type:"number",value:me.base_salary,onChange:t=>ee("base_salary",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"أدخل المبلغ",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ الاستحقاق"}),e.jsx("input",{type:"date",value:me.effective_date,onChange:t=>ee("effective_date",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsx("button",{type:"submit",disabled:ue,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:ue?"جاري الحفظ...":"حفظ"}),e.jsx("button",{type:"button",onClick:()=>{M(!1),G(null),te()},className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-lg hover:bg-gray-300 transition duration-200",children:"إلغاء"})]})]})]})})})]})]})}export{Ct as default};
